"use strict";(self["webpackChunkRaingad_IM"]=self["webpackChunkRaingad_IM"]||[]).push([[761],{9761:function(t,s,a){a.r(s),a.d(s,{default:function(){return _}});var e=function(){var t=this,s=t._self._c;return s("div",{staticClass:"pd-20"},[s("el-row",{attrs:{gutter:20}},[t.globalConfig&&t.globalConfig.demon_mode?s("el-col",{attrs:{span:12}},[s("el-card",{staticClass:"mb-20",attrs:{shadow:"hover",header:"欢迎"}},[s("div",{staticClass:"welcome"},[s("div",{staticClass:"logo"},[s("img",{attrs:{src:a(5080)}}),s("h2",[t._v("欢迎体验 "+t._s(t.$packageData.name))])]),s("div",{staticClass:"mt-20"},[s("p",{staticClass:"item-background"},[t._v(t._s(t.$packageData.name)+"是一个"),s("b",{staticClass:"c-red"},[t._v("开源的即时通信demo，主要用于学习交流，为大家提供即时通讯的开发思路")]),t._v("，许多功能需要自行开发，开发的初衷旨在快速建立企业内部通讯系统、内网交流、社区交流。不建议用于商业用途，如确有需要商用，请联系作者授权，自行开发代码量必须要高于原代码量的30%以上，重构UI，并注明相关的版权问题。")]),s("div",{staticClass:"mt-15 ml-15 mb-15"},[s("span",[t._v(" 前端地址："),s("a",{attrs:{href:t.$packageData.frontUrl,target:"_blank"}},[s("el-image",{attrs:{src:t.$packageData.frontUrl+"/badge/star.svg?theme=white",alt:"star"}})],1)]),t._v("   "),s("span",{},[t._v(" 后端地址："),s("a",{attrs:{href:t.$packageData.backstageUrl,target:"_blank"}},[s("el-image",{attrs:{src:t.$packageData.backstageUrl+"/badge/star.svg?theme=dark",alt:"star"}})],1)])])]),s("div",{staticClass:"tips"},t._l(t.$packageData.funcList,(function(a){return s("div",{key:a.icon,staticClass:"tips-item"},[s("div",{staticClass:"tips-item-icon"},[s("i",{class:a.icon})]),s("div",{staticClass:"tips-item-message",domProps:{textContent:t._s(a.text)}})])})),0),s("div",{staticClass:"actions"},[s("router-link",{attrs:{to:"/chat"}},[s("el-button",{attrs:{type:"primary",icon:"el-icon-s-promotion",size:"large"}},[t._v("去聊天")])],1)],1)])])],1):t._e(),s("el-col",{attrs:{span:4}},[s("el-card",{staticClass:"mb-20",attrs:{shadow:"hover",header:""}},[s("im-statistic",{attrs:{title:"用户总数",value:t.statistics.userCount,suffix:"个",groupSeparator:""}})],1)],1),s("el-col",{attrs:{span:4}},[s("el-card",{staticClass:"mb-20",attrs:{shadow:"hover",header:""}},[s("im-statistic",{attrs:{title:"在线用户",value:t.statistics.onlineCount,suffix:"个",groupSeparator:""}})],1)],1),s("el-col",{attrs:{span:4}},[s("el-card",{staticClass:"mb-20",attrs:{shadow:"hover",header:""}},[s("im-statistic",{attrs:{title:"在线设备",value:t.statistics.clientCount,suffix:"个",groupSeparator:""}})],1)],1),s("el-col",{attrs:{span:4}},[s("el-card",{staticClass:"mb-20",attrs:{shadow:"hover",header:""}},[s("im-statistic",{attrs:{title:"群聊总数",value:t.statistics.groupCount,suffix:"个",groupSeparator:""}})],1)],1),s("el-col",{attrs:{span:4}},[s("el-card",{staticClass:"mb-20",attrs:{shadow:"hover",header:""}},[s("im-statistic",{attrs:{title:"消息总数",value:t.statistics.messageCount,suffix:"条",groupSeparator:""}})],1)],1),s("el-col",{attrs:{span:4}},[s("el-card",{staticClass:"mb-20",attrs:{shadow:"hover",header:""}},[s("im-statistic",{attrs:{title:"文件总数",value:t.statistics.fileCount,suffix:"个",groupSeparator:""}})],1)],1),s("el-col",{attrs:{span:12}},[s("el-card",{staticClass:"mb-20",attrs:{shadow:"hover",header:""}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[t._v("系统公告")]),s("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(s){t.noticeBox=!0}}},[t._v("发布公告")])],1),t._l(t.noticeList,(function(a,e){return s("div",{key:e,staticClass:"lz-flex lz-space-between"},[s("div",{staticClass:"mb-5 text-overflow cur-handle",staticStyle:{width:"70%"},on:{click:function(s){return t.viewNotice(a)}}},[s("span",{staticClass:"el-icon el-icon-collection-tag mr-5"}),t._v(" "+t._s(a.title)+" ")]),s("div",{staticClass:"c-999"},[t._v(t._s(a.create_time))])])})),s("el-pagination",{staticClass:"mt-10",attrs:{background:"",layout:"prev, pager, next","page-size":t.noticeParam.limit,"current-page":t.noticeParam.page,total:t.noticeTotal},on:{"update:currentPage":function(s){return t.$set(t.noticeParam,"page",s)},"update:current-page":function(s){return t.$set(t.noticeParam,"page",s)},"current-change":t.getNoticeList}})],2),s("el-dialog",{attrs:{title:(t.notice.msgId?"编辑":"发布")+"公告",width:"500px",visible:t.noticeBox},on:{"update:visible":function(s){t.noticeBox=s}}},[s("el-form",{attrs:{model:t.notice}},[s("el-form-item",{attrs:{label:"公告标题"}},[s("el-input",{model:{value:t.notice.title,callback:function(s){t.$set(t.notice,"title",s)},expression:"notice.title"}})],1),s("el-form-item",{attrs:{label:"公告内容"}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:20}},model:{value:t.notice.content,callback:function(s){t.$set(t.notice,"content",s)},expression:"notice.content"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.cancelPublish}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.publishNotice}},[t._v(t._s(t.notice.msgId?"更新":"发布"))])],1)],1)],1),s("el-col",{attrs:{span:12}},[s("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"task task-item mb-20",attrs:{shadow:"hover"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[t._v("系统服务")]),s("span",{staticClass:"handler",staticStyle:{float:"right","margin-top":"-3px"}},[s("i",{staticClass:"f-24 c-999 cur-handle",class:t.taskStatus?"el-icon-video-pause stop-task":"el-icon-video-play start-task",staticStyle:{padding:"3px"},attrs:{type:"primary"},on:{click:t.startService}})])]),s("el-alert",{attrs:{type:"warning",title:"系统服务使用要求运行的PHP的版本必须是默认的，并且可以直接执行PHP命令。如果启动失败可能是某些函数被禁用或者runtime的目录没有写入权限，可以在终端中运行 ‘php think task start’ 来调试程序的错误。","show-icon":"",closable:!1}}),t._l(t.taskList,(function(a,e){return s("div",{key:e,staticClass:"lz-flex lz-space-between mt-10 mb-10 lz-align-items-center"},[s("div",{staticClass:"task-name el-icon-timer"},[t._v(" "+t._s(a.remark)+" ")]),s("div",{staticClass:"el-icon-alarm-clock"},[t._v(" "+t._s(a.started)+" ")]),"active"==a.status?s("div",{staticClass:"c-green"},[t._v("运行中")]):s("div",{staticClass:"c-red"},[t._v("未启动")]),s("el-button",{staticClass:"ml-10",attrs:{size:"mini",type:"text"},on:{click:function(s){return t.showLog(a.name)}}},[t._v("日志")])],1)})),s("el-dialog",{attrs:{width:"900px",title:"运行日志",visible:t.dialogTableVisible},on:{"update:visible":function(s){t.dialogTableVisible=s}}},[s("el-button",{on:{click:t.clearTaskLog}},[t._v("清除进程日志")]),s("div",{staticClass:"mt-10",staticStyle:{height:"500px"}},[s("el-scrollbar",[s("div",{staticClass:"task-log pd-10"},[t._v(t._s(t.taskLog))])])],1)],1)],2)],1)],1)],1)},i=[],o=a(3822),c=a(4462),l=a.n(c),n=function(){var t=this,s=t._self._c;return s("div",{staticClass:"im-statistic"},[s("div",{staticClass:"im-statistic-title"},[t._v(" "+t._s(t.title)+" "),t.tips?s("el-tooltip",{attrs:{effect:"light"},scopedSlots:t._u([{key:"content",fn:function(){return[s("div",{staticStyle:{width:"200px","line-height":"2"}},[t._v(" "+t._s(t.tips)+" ")])]},proxy:!0}],null,!1,3172997100)},[s("div",{staticClass:"im-statistic-tips"},[s("i",{staticClass:"el-icon el-icon-question"})])]):t._e()],1),s("div",{staticClass:"im-statistic-content"},[t.prefix?s("span",{staticClass:"im-statistic-content-prefix"},[t._v(t._s(t.prefix))]):t._e(),s("span",{staticClass:"im-statistic-content-value"},[t._v(t._s(t.cmtValue))]),t.suffix?s("span",{staticClass:"im-statistic-content-suffix"},[t._v(t._s(t.suffix))]):t._e()]),t.description||t.$slots.default?s("div",{staticClass:"im-statistic-description"},[t._t("default",(function(){return[t._v(" "+t._s(t.description)+" ")]}))],2):t._e()])},r=[],d=a(2325),p={props:{title:{type:String,required:!0,default:""},value:{type:Number,required:!0,default:0},prefix:{type:String,default:""},suffix:{type:String,default:""},description:{type:String,default:""},tips:{type:String,default:""},groupSeparator:{type:Boolean,default:!1}},data(){return{}},computed:{cmtValue(){return this.groupSeparator?(0,d.dB)(this.value):this.value}}},u=p,h=a(1001),m=(0,h.Z)(u,n,r,!1,null,"1052b203",null),g=m.exports,v={components:{imStatistic:g},computed:{...(0,o.rn)({globalConfig:t=>t.globalConfig,socketAction:t=>t.socketAction})},watch:{socketAction(t){let s=t.data;"statistics"==t.type&&Object.assign(this.statistics,s)}},data(){return{loading:!1,taskStatus:!1,taskList:[],curName:"",dialogTableVisible:!1,taskLog:"",noticeBox:!1,noticeList:[],statistics:{},notice:{msgId:0,title:"",content:""},noticeParam:{page:1,limit:10},noticeTotal:0,task:[{name:"im_task_schedule",started:"--",status:"stop",remark:"计划任务"},{name:"im_task_queue",started:"--",status:"stop",remark:"消息队列"},{name:"im_task_worker",started:"--",status:"stop",remark:"消息推送"}]}},mounted(){this.resetTask(),this.getTaskList(),this.getSta(),this.getNoticeList()},methods:{resetTask(){let t=this.task;this.taskList=t},getTaskList(){this.$api.taskApi.getTaskList().then((t=>{400==t.code?this.taskStatus=!1:0==t.code&&(this.taskStatus=!0,this.taskList=t.data)}))},getNoticeList(){this.$api.commonApi.getNoticeList(this.noticeParam).then((t=>{0==t.code&&(this.noticeList=t.data,this.noticeTotal=t.count)}))},getSta(){this.$api.commonApi.systemSta({client_id:l().get("client_id")}).then((t=>{0==t.code&&(this.statistics=t.data)}))},startService(){this.loading=!0,0==this.taskStatus?this.$api.taskApi.startTask().then((t=>{this.loading=!1,0==t.code&&this.getTaskList()})):this.$confirm("确定要停止服务吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$api.taskApi.stopTask().then((t=>{this.loading=!1,0==t.code&&(this.taskStatus=!1,this.resetTask())}))})).catch((()=>{this.loading=!1,this.$message({type:"info",message:"已取消停止"})}))},showLog(t){this.curName=t,this.$api.taskApi.getTaskLog({name:t}).then((t=>{if(0==t.code){if(""==t.data)return this.$message.error("暂无日志");this.dialogTableVisible=!0,this.taskLog=t.data}}))},clearTaskLog(){this.$confirm("确定要清除日志吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$api.taskApi.clearTaskLog({name:this.curName}).then((t=>{0==t.code&&(this.dialogTableVisible=!1,this.taskLog="")}))})).catch((()=>{}))},publishNotice(){this.$api.commonApi.publishNotice(this.notice).then((t=>{this.noticeBox=!1,0==t.code&&(this.cancelPublish(),this.getNoticeList())}))},cancelPublish(){this.noticeBox=!1,this.notice={msgId:0,title:"",content:""}},viewNotice(t){this.noticeBox=!0,this.notice={msgId:t.msg_id,title:t.extends.title,content:t.extends.notice??""}}}},f=v,k=(0,h.Z)(f,e,i,!1,null,"f23837a6",null),_=k.exports},5080:function(t,s,a){t.exports=a.p+"assets/img/logo.e8099414.png"}}]);