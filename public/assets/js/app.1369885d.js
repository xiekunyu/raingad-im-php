(function(){var __webpack_modules__={6959:function(e,t,s){"use strict";s.d(t,{Z:function(){return E}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"chat-main"},[t("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入关键字搜索聊天"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchMessage},slot:"append"})],1),t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"全部",name:"all"}},[t("div",{staticClass:"el-tab-body-list"},[t("el-scrollbar",{staticStyle:{height:"100%"}},e._l(e.dataList,(function(e,s){return t("ChatItem",{key:s,attrs:{data:e}})})),1)],1)]),t("el-tab-pane",{attrs:{label:"文本",name:"text"}},[t("div",{staticClass:"el-tab-body-list"},[t("el-scrollbar",{staticStyle:{height:"100%"}},e._l(e.dataList,(function(e,s){return t("ChatItem",{key:s,attrs:{data:e}})})),1)],1)]),t("el-tab-pane",{attrs:{label:"图片",name:"image"}},[t("div",{staticClass:"el-tab-body-list"},[t("el-scrollbar",{staticStyle:{height:"100%"}},[t("el-row",{staticStyle:{}},e._l(e.dataList,(function(s,i){return t("ChatImage",{key:i,attrs:{data:s,previewUrl:e.previewList}})})),1)],1)],1)]),t("el-tab-pane",{attrs:{label:"视频",name:"video"}},[t("div",{staticClass:"el-tab-body-list"},[t("el-scrollbar",{staticStyle:{height:"100%"}},e._l(e.dataList,(function(e,s){return t("ChatItem",{key:s,attrs:{data:e}})})),1)],1)]),t("el-tab-pane",{attrs:{label:"文件",name:"file"}},[t("div",{staticClass:"el-tab-body-list"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,height:"450"}},[t("el-table-column",{attrs:{prop:"fileName",label:"文件",width:"300"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",{staticClass:"chat-file"},[t("div",[t("el-image",{staticClass:"fileExt",attrs:{fit:"cover",src:e.fileExt(s.row.fileName)}})],1),t("div",{staticClass:"fileName"},[e._v(e._s(s.row.fileName))])])]}}])}),t("el-table-column",{attrs:{prop:"sendTime",label:"上传时间",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatTime(t.row.sendTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"fileSize",label:"大小",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.fileSize(t.row.fileSize))+" ")]}}])}),t("el-table-column",{attrs:{prop:"fromUser.realname",label:"上传者",width:"100"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.downloadFile(s.row)}}},[e._v("下载")])]}}])})],1)],1)])],1),t("el-pagination",{attrs:{background:"","hide-on-single-page":e.singlePage,"page-size":e.listRows,"current-page":e.pageSize,layout:"prev, pager, next",total:e.total},on:{"update:pageSize":function(t){e.listRows=t},"update:page-size":function(t){e.listRows=t},"update:currentPage":function(t){e.pageSize=t},"update:current-page":function(t){e.pageSize=t},"current-change":e.handleCurrentChange}})],1)},a=[],n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"chat-list-item"},[t("div",{staticClass:"chat-list-avatar"},[t("el-avatar",{attrs:{shape:"square",size:"medium",src:e.data.fromUser.avatar}})],1),t("div",{staticClass:"chat-list-body"},[t("div",{staticClass:"chat-list-title"},[e._v(" "+e._s(e.data.fromUser.realname)+" "),t("span",{staticClass:"time"},[e._v(" "+e._s(e.formatTime(e.data.sendTime)))])]),"text"==e.data.type?t("div",{staticClass:"chat-list-text",domProps:{innerHTML:e._s(e.data.content)}}):e._e(),"text"==e.data.type?t("div",{staticClass:"chat-list-tools"},[t("el-tooltip",{attrs:{effect:"dark",content:"复制文本",placement:"top"}},[t("i",{staticClass:"el-icon-document-copy",on:{click:function(t){return e.copyText(e.data.content)}}})])],1):e._e(),"image"==e.data.type?t("div",{staticClass:"chat-list-image"},[t("el-image",{staticStyle:{"max-width":"300px","max-height":"200px"},attrs:{src:e.data.content,"z-index":3e3,"preview-src-list":[e.data.content],fit:"contain"}})],1):e._e(),"video"==e.data.type?t("div",{staticClass:"chat-list-video"},[t("video",{staticStyle:{"max-width":"300px","max-height":"200px"},attrs:{src:e.data.content,controls:""}})]):e._e(),"file"==e.data.type?t("div",{staticClass:"chat-list-file"},[t("el-card",{staticStyle:{width:"260px"},attrs:{"body-style":{padding:"10px 10px 0 10px"}}},[t("div",{staticClass:"chat-file-content"},[t("div",{staticClass:"chat-file-ext"},[t("el-image",{staticStyle:{width:"35px"},attrs:{src:e.fileExt(e.data.fileName),fit:"fill"}})],1),t("div",{staticClass:"chat-file-title"},[t("div",{staticClass:"chat-file-name"},[t("span",{staticClass:"fileName"},[e._v(e._s(e.data.fileName)+" ")]),t("span",{staticClass:"fileSize"},[e._v("("+e._s(e.fileSize(e.data.fileSize))+")")])]),t("div",{staticClass:"chat-file-remark"},[e._v(" 文件已成功发送, 文件助手永久保存 ")])])]),t("hr"),t("div",{staticClass:"bottom clearfix",attrs:{align:"right"}},[t("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(t){return e.downloadFile(e.data)}}},[e._v("下载")]),t("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(t){return e.onlinePreview(e.data)}}},[e._v("在线预览")])],1)])],1):e._e()]),t("preview",{key:e.componentKey,attrs:{drawer:e.drawer,previewUrl:e.previewUrl}})],1)},r=[],o=s(2325),c=s(9576);function l(e){let t=new Array(" B"," KB"," MB"," GB"," TB"),s=e+"B";for(let i=0;e>=1024&&i<4;i++)e/=1024,s=e.toFixed(2)+t[i+1];return s}function d(e){var t="https://file.lcoce.com/ext/",s=e.split("."),i=s[s.length-1],a=i.toUpperCase(),n=["jpg","jpeg","png","bmp","gif","pdf","mp3","wav","wmv","amr","mp4","3gp","avi","m2v","mkv","mov","webp","ppt","pptx","doc","docx","xls","xlsx","pdf"];return n.includes(a)?t+a+".png":t+"icon/document.svg"}function u(e,t,s){let i=document.createElement("a");i.download="image"==s?t||"pic":t||"file",i.href=e,i.click()}var _={name:"chatItem",components:{preview:c.Z},props:{data:{type:Object,default:{}}},computed:{formatTime(){return function(e){return e=parseInt(e/1e3),(0,o.hT)("Y/m/d H:i:s",e)}},fileSize(){return function(e){return l(e)}},fileExt(){return function(e){return d(e)}}},data(){return{drawer:!1,previewUrl:"",componentKey:1}},methods:{copyText(e){this.$clipboard(e),this.$message({type:"success",message:"复制成功!"})},onlinePreview(e){this.drawer=!0,this.componentKey+=1,this.previewUrl=e.preview},downloadFile(e){u(e.content,e.fileName,e.type)}},created(){}},p=_,m=s(1001),h=(0,m.Z)(p,n,r,!1,null,"05fd971f",null),g=h.exports,f=function(){var e=this,t=e._self._c;return t("div",[t("el-col",{staticStyle:{padding:"0 12px 12px 0"},attrs:{span:6}},["image"==e.data.type?t("el-card",{attrs:{"body-style":{padding:"0px"}}},[t("el-image",{staticStyle:{width:"100%",height:"120px"},attrs:{src:e.data.content,"preview-src-list":e.previewUrl,"z-index":9999,fit:"cover"}}),t("div",{staticStyle:{padding:"10px"}},[t("div",{staticClass:"bottom clearfix"},[t("time",{staticClass:"time"},[e._v(e._s(e.data.fromUser.realname)+" 上传于 "+e._s(e.formatTime(e.data.sendTime)))])])])],1):e._e()],1)],1)},v=[],w={name:"chatImage",props:{data:{type:Object,default:{}},previewUrl:{type:Array,default:function(){return[]}}},computed:{formatTime(){return function(e){return e=parseInt(e/1e3),(0,o.hT)("Y/m/d",e)}},fileSize(){return function(e){return l(e)}},fileExt(){return function(e){return d(e)}}},data(){return{currentDate:new Date}},methods:{copyText(e){this.$clipboard(e),this.$message({type:"success",message:"复制成功!"})},downloadFile(e){u(e.content,e.fileName,e.type)}},created(){}},C=w,b=(0,m.Z)(C,f,v,!1,null,"ac5764cc",null),y=b.exports,M=s(1739),x={name:"chatRecord",components:{ChatItem:g,ChatImage:y},props:{contact:{type:Object,default:{}}},computed:{formatTime(){return function(e){return e/=1e3,(0,o.hT)("Y/m/d H:i:s",e)}},fileSize(){return function(e){return l(e)}},fileExt(){return function(e){return d(e)}}},data(){return{activeName:"all",keywords:"",msgType:"all",pageSize:1,listRows:20,total:0,singlePage:!1,dataList:[],previewList:[]}},methods:{handleClick(e,t){this.pageSize=1,this.msgType=e.name,this.getMessage()},searchMessage(){this.getMessage()},getMessage(){(0,M.lX)({toContactId:this.contact.id,is_group:this.contact.is_group,type:this.msgType,keywords:this.keywords,pageSize:this.pageSize,listRows:this.listRows}).then((e=>{this.dataList=e.data,this.total=e.count,e.count<=this.listRows?this.singlePage=!0:this.singlePage=!1,"image"==this.msgType&&(this.previewList=(0,o.Nj)(e.data,"content",!1))})).catch((e=>{console.log(e)}))},handleCurrentChange(e){console.log(e),this.pageSize=e,this.getMessage()},downloadFile(e){u(e.content,e.fileName,e.type)}},created(){this.getMessage()},mounted(){}},k=x,D=(0,m.Z)(k,i,a,!1,null,"5f1b026e",null),E=D.exports},9699:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"group-item"},[t("div",{staticClass:"group-avatar"},[t("el-avatar",{attrs:{shape:"square",src:e.contact.avatar}})],1),t("div",{staticClass:"group-content"},[t("div",{staticClass:"group-title"},[e._v(e._s(e.contact.displayName)+" "),t("span",[e._v("("+e._s(e.groupInfo.groupUserCount)+")")])]),t("div",{staticClass:"group-user"},[e._v("群主："+e._s(e.groupInfo.ownerName))])])]),t("div",{staticClass:"setting-item"},[t("div",{staticClass:"setting-title"},[e._v("群管理：")]),t("div",{staticClass:"setting-option"},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},on:{change:e.groupSetting},model:{value:e.setting.manage,callback:function(t){e.$set(e.setting,"manage",t)},expression:"setting.manage"}})],1),e._m(0)]),t("div",{staticClass:"setting-item"},[t("div",{staticClass:"setting-title"},[e._v("群成员邀请：")]),t("div",{staticClass:"setting-option"},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},on:{change:e.groupSetting},model:{value:e.setting.invite,callback:function(t){e.$set(e.setting,"invite",t)},expression:"setting.invite"}})],1),e._m(1)]),t("div",{staticClass:"setting-item"},[t("div",{staticClass:"setting-title"},[e._v("群禁言：")]),t("div",{staticClass:"setting-option"},[t("el-radio-group",{attrs:{size:"mini"},on:{change:e.groupSetting},model:{value:e.setting.nospeak,callback:function(t){e.$set(e.setting,"nospeak",t)},expression:"setting.nospeak"}},[t("el-radio-button",{attrs:{label:"0"}},[e._v("关闭")]),t("el-radio-button",{attrs:{label:"1"}},[e._v("仅管理员可发言")]),t("el-radio-button",{attrs:{label:"2"}},[e._v("仅群主可发言")])],1)],1)])])},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"setting-description"},[t("div",{staticClass:"des-title"},[e._v("仅群主和群管理员可以管理")]),t("div",{staticClass:"des-comment"},[e._v("启用后，其他成员不能修改群名称，编辑公告等")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"setting-description"},[t("div",{staticClass:"des-title"},[e._v("允许群成员邀请")]),t("div",{staticClass:"des-comment"},[e._v("启用后，其他成员可以邀请其他人加入群聊")])])}],n=s(1739),r={name:"chatSet",props:{contact:{type:Object,default:{}}},data(){return{setting:{},groupInfo:{}}},methods:{groupSetting(){(0,n.rb)({id:this.contact.id,setting:this.setting})}},created(){(0,n.Wy)({group_id:this.contact.id}).then((e=>{var t=e.data;this.groupInfo=t,this.setting=t.setting}))}},o=r,c=s(1001),l=(0,c.Z)(o,i,a,!1,null,"7ee59623",null),d=l.exports},8288:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"chatTop"},[t("el-tooltip",{attrs:{content:e.contact.displayName,placement:"top-start",effect:"light"}},[t("div",{staticClass:"top-item",class:e.currentId==e.contact.id?"active":""},[t("div",{staticClass:"avatar"},[t("el-avatar",{attrs:{shape:e.avatarCricle?"circle":"square",size:"small",src:e.contact.avatar}})],1),t("div",{staticClass:"username"},[e._v(" "+e._s(e.contact.displayName)+" ")])])])],1)},a=[],n={name:"chatTop",props:{contact:{type:Object,default:{}},currentId:[String,Number],avatarCricle:{type:Boolean,default:!1}},data(){return{}},methods:{},created(){}},r=n,o=s(1001),c=(0,o.Z)(r,i,a,!1,null,"4d6c8b50",null),l=c.exports},3943:function(e,t,s){"use strict";s.d(t,{Z:function(){return u}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"lum-dialog-mask animated fadeIn"},[t("el-container",{staticClass:"lum-dialog-box"},[t("el-main",{staticClass:"no-padding mian"},[t("div",{staticClass:"music"},[t("span",{staticClass:"line line1",class:{"line-ani":e.animation}}),t("span",{staticClass:"line line2",class:{"line-ani":e.animation}}),t("span",{staticClass:"line line3",class:{"line-ani":e.animation}}),t("span",{staticClass:"line line4",class:{"line-ani":e.animation}}),t("span",{staticClass:"line line5",class:{"line-ani":e.animation}})]),t("div",{staticStyle:{"margin-top":"35px",color:"#676262","font-weight":"300"}},[0==e.recorderStatus?[t("p",{staticStyle:{"font-size":"13px","margin-top":"5px"}},[t("span",[e._v("语音消息，让聊天更简单方便 ...")])])]:1==e.recorderStatus||2==e.recorderStatus||3==e.recorderStatus?[t("p",[e._v(e._s(e.datetime))]),t("p",{staticStyle:{"font-size":"13px","margin-top":"5px"}},[1==e.recorderStatus?t("span",[e._v("正在录音...")]):2==e.recorderStatus?t("span",[e._v("已暂停录音")]):3==e.recorderStatus?t("span",[e._v("录音时长")]):e._e()])]:4==e.recorderStatus||5==e.recorderStatus||6==e.recorderStatus?[t("p",[e._v(e._s(e.formatPlayTime))]),t("p",{staticStyle:{"font-size":"13px","margin-top":"5px"}},[4==e.recorderStatus?t("span",[e._v("正在播放")]):5==e.recorderStatus?t("span",[e._v("已暂停播放")]):6==e.recorderStatus?t("span",[e._v("播放已结束")]):e._e()])]:e._e()],2)]),t("el-footer",{staticClass:"footer",attrs:{height:"60px"}},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.recorderStatus,expression:"recorderStatus == 0"}],attrs:{type:"primary",size:"small",round:"",icon:"el-icon-microphone"},on:{click:e.startRecorder}},[e._v("开始录音 ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.recorderStatus,expression:"recorderStatus == 1"}],attrs:{type:"warning",size:"small",round:"",icon:"el-icon-video-pause"},on:{click:e.pauseRecorder}},[e._v("暂停录音 ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.recorderStatus,expression:"recorderStatus == 2"}],attrs:{type:"primary",size:"small",round:"",icon:"el-icon-microphone"},on:{click:e.resumeRecorder}},[e._v("继续录音 ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:(2==e.recorderStatus||1==e.recorderStatus)&&e.duration>1,expression:"(recorderStatus == 2 || recorderStatus == 1) && duration>1"}],attrs:{type:"danger",size:"small",round:"",icon:"el-icon-microphone"},on:{click:e.stopRecorder}},[e._v("结束录音 ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:3==e.recorderStatus||6==e.recorderStatus,expression:"recorderStatus == 3 || recorderStatus == 6"}],attrs:{type:"success",size:"small",round:"",icon:"el-icon-video-play"},on:{click:e.playRecorder}},[e._v("播放录音 ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:3==e.recorderStatus||5==e.recorderStatus||6==e.recorderStatus,expression:"\n          recorderStatus == 3 || recorderStatus == 5 || recorderStatus == 6\n        "}],attrs:{type:"warning",size:"small",round:"",icon:"el-icon-refresh-right"},on:{click:e.startRecorder}},[e._v("重新录音 ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:4==e.recorderStatus,expression:"recorderStatus == 4"}],attrs:{type:"info",size:"small",round:"",icon:"el-icon-video-pause"},on:{click:e.pausePlayRecorder}},[e._v("暂停播放 ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:5==e.recorderStatus,expression:"recorderStatus == 5"}],attrs:{type:"success",size:"small",round:"",icon:"el-icon-video-play"},on:{click:e.resumePlayRecorder}},[e._v("继续播放 ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:3==e.recorderStatus||5==e.recorderStatus||6==e.recorderStatus,expression:"\n          recorderStatus == 3 || recorderStatus == 5 || recorderStatus == 6\n        "}],attrs:{type:"primary",size:"small",round:""},on:{click:e.submit}},[e._v("立即发送 ")])],1)],1)],1)},a=[],n=s(7362),r=s.n(n),o={name:"voiceRecorder",data(){return{recorder:null,duration:0,playTime:0,animation:!1,recorderStatus:0,playTimeout:null}},computed:{datetime(){let e=parseInt(this.duration/60/60%24),t=parseInt(this.duration/60%60),s=parseInt(this.duration%60);return e<10&&(e=`0${e}`),t<10&&(t=`0${t}`),s<10&&(s=`0${s}`),`${e}:${t}:${s}`},formatPlayTime(){let e=parseInt(this.playTime/60/60%24),t=parseInt(this.playTime/60%60),s=parseInt(this.playTime%60);return e<10&&(e=`0${e}`),t<10&&(t=`0${t}`),s<10&&(s=`0${s}`),`${e}:${t}:${s}`}},destroyed(){this.recorder&&this.destroyRecorder()},methods:{closeBox(){null!=this.recorder?(1==this.recorderStatus?this.stopRecorder():4==this.recorderStatus&&this.pausePlayRecorder(),this.destroyRecorder((()=>{this.$emit("close",!1)}))):this.$emit("close",!1)},startRecorder(){let e=this;this.recorder=new(r()),this.recorder.onprocess=t=>{t=parseInt(t),e.duration=t},this.recorder.start().then((()=>{this.recorderStatus=1,this.animation=!0}),(e=>{console.log(`${e.name} : ${e.message}`)}))},pauseRecorder(){this.recorder.pause(),this.recorderStatus=2,this.animation=!1},resumeRecorder(){this.recorderStatus=1,this.recorder.resume(),this.animation=!0},stopRecorder(){this.recorderStatus=3,this.recorder.stop(),this.animation=!1},playRecorder(){this.recorderStatus=4,this.recorder.play(),this.playTimeouts(),this.animation=!0},pausePlayRecorder(){this.recorderStatus=5,this.recorder.pausePlay(),clearInterval(this.playTimeout),this.animation=!1},resumePlayRecorder(){this.recorderStatus=4,this.recorder.resumePlay(),this.playTimeouts(),this.animation=!0},destroyRecorder(e){this.recorder.destroy().then((()=>{this.recorder=null,e&&e()}))},recorderSize(){return this.recorder.fileSize},playTimeouts(){this.playTimeout=setInterval((()=>{let e=parseInt(this.recorder.getPlayTime());this.playTime=e,e==this.duration&&(clearInterval(this.playTimeout),this.animation=!1,this.recorderStatus=6)}),100)},submit(){let e=this.recorder.getWAVBlob(),t=new File([e],"在线录音.wav",{type:e.type,lastModified:Date.now()});this.$emit("send",this.duration,t)}}},c=o,l=s(1001),d=(0,l.Z)(c,i,a,!1,null,"1ca7c568",null),u=d.exports},9576:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var i=function(){var e=this,t=e._self._c;return t("div",[t("transition",{attrs:{name:"fade-user"}},[e.myDrawer?t("div",{staticClass:"previewBox"},[t("el-button",{staticClass:"drawer-close",attrs:{type:"danger",icon:"el-icon-close",circle:""},on:{click:e.closeDrawer}}),t("iframe",{attrs:{src:e.previewUrl,frameborder:"0",width:"100%",height:"100%"}})],1):e._e()])],1)},a=[],n={name:"preview",props:{drawer:{type:Boolean,default:!1},previewUrl:{type:String,default:""}},data(){return{myDrawer:this.drawer}},methods:{closeDrawer(){this.myDrawer=!1}},created(){}},r=n,o=s(1001),c=(0,o.Z)(r,i,a,!1,null,"20778d58",null),l=c.exports},8150:function(e,t,s){"use strict";s.d(t,{Z:function(){return p}});var i=function(){var e=this;e._self._c;return e._m(0)},a=[function(){var e=this,t=e._self._c;return t("div",[t("audio",{attrs:{id:"chatAudio"}},[t("source",{attrs:{src:s(444),type:"audio/mpeg"}})])])}],n=s(3032),r=s(2223),o=s(4462),c=s.n(o),l={name:"socket",data(){return{websocket:null}},methods:{getWsUrl(){let e="wss://im.raingad.com/wss";var t=document.domain,s=window.location.protocol,i="ws://";return"https:"==s&&(i="wss://"),e=i+t+"/wss",console.log(e),e},initWebSocket(){const e=this.getWsUrl();this.websocket=new WebSocket(e),this.websocket.onmessage=this.websocketOnMessage,this.websocket.onclose=this.websocketClose,n["default"].prototype.$websocket=this.websocket},websocketOnMessage(e){const t=JSON.parse(e.data);let s=c().get("UserInfo");switch(t["type"]){case"ping":this.websocketSend({type:"pong"});break;case"init":c().set("client_id",t["client_id"]),(0,r.uc)({client_id:t["client_id"],user_id:s.user_id}).then((e=>{this.websocketSend({type:"bindUid",user_id:s.user_id}),console.log(t["client_id"],"消息服务启动成功")})).catch((e=>{console.log("连接失败")}));break;default:this.$store.commit("catchSocketAction",t);break}},websocketSend(e){var t=JSON.stringify(e);this.websocket.send(t)},websocketClose(e){let t=c().get("UserInfo");(0,r.Ig)({user_id:t.user_id}).then((t=>{console.log("connection closed ("+e.code+")")}))},playAudio(){const e=document.getElementById("chatAudio");e.currentTime=0,e.play()}},created(){this.initWebSocket()}},d=l,u=s(1001),_=(0,u.Z)(d,i,a,!1,null,null,null),p=_.exports},8246:function(e,t,s){"use strict";s.d(t,{Z:function(){return _}});var i=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"status"}],staticClass:"webrtc-box"},[e._m(0),e._m(1),t("video",{directives:[{name:"show",rawName:"v-show",value:e.localStream&&e.is_video,expression:"localStream && is_video"}],ref:"localvideo",staticClass:"localvideo",attrs:{autoplay:"",playsinline:""}}),t("video",{directives:[{name:"show",rawName:"v-show",value:e.remoteStream&&e.is_video,expression:"remoteStream && is_video"}],ref:"remotevideo",staticClass:"remotevideo",attrs:{autoplay:"",playsinline:""}}),t("div",[e.caller?t("div",{staticClass:"call-user"},[2==e.status&&e.is_video?e._e():t("img",{staticClass:"avatar",attrs:{src:e.caller.avatar,alt:""}}),t("div",{staticClass:"text"},[e.is_video||2!=e.status?e._e():t("b",[e._v(e._s(e.caller.displayName))]),2!=e.status?t("span",[e.isReceived?t("span",[e._v(" "+e._s(e.caller.displayName)+" 正在请求与您"+e._s(e.is_video?"视频":"语音")+"通话")]):t("span",[e._v("您正对 "),t("b",[e._v(e._s(e.caller.displayName))]),e._v(" 发起"+e._s(e.is_video?"视频":"语音")+"通话")])]):e._e()])]):e._e(),t("div",{staticClass:"calling-button"},[e.calling&&3==e.status?t("div",{staticClass:"button"},[t("img",{staticClass:"image",attrs:{src:"https://im.file.raingad.com/static/image/jieting.png"},on:{click:function(t){return e.answer()}}}),t("div",{staticClass:"text"},[e._v("接听")])]):e._e(),2==e.status?t("div",{staticClass:"button"},[t("img",{staticClass:"image-icon",attrs:{src:"https://im.file.raingad.com/static/image/voice"+(e.voiceStatus?"":"-off")+".png"},on:{click:function(t){return e.switchVoice()}}})]):e._e(),e.calling&&0!=e.status?t("div",{staticClass:"button"},[t("img",{staticClass:"image",attrs:{src:"https://im.file.raingad.com/static/image/guaduan.png"},on:{click:function(t){return e.hangup(!0)}}}),t("div",{staticClass:"text"},[e._v("挂断")])]):e._e(),2==e.status?t("div",{staticClass:"button"},[e.is_video?t("img",{staticClass:"image-icon",attrs:{src:"https://im.file.raingad.com/static/image/camera"+(e.videoStatus?"":"-off")+".png"},on:{click:function(t){return e.switchVideo()}}}):t("div",{staticClass:"image-icon"})]):e._e()])])])},a=[function(){var e=this,t=e._self._c;return t("audio",{attrs:{id:"music1"}},[t("source",{attrs:{src:"https://im.file.raingad.com/static/voice/calling.mp3"}})])},function(){var e=this,t=e._self._c;return t("audio",{attrs:{id:"music2"}},[t("source",{attrs:{src:"https://im.file.raingad.com/static/voice/guaduan.mp3"}})])}],n=(s(7658),s(2801),"jsjiami.com.v6"),r=[n,"w5l9wq13wq5M","TXPDrXLDnA==","wpPDs8OxwrIaw6Y=","CmzCncKL","w4jCmcKwbsK7","asO4wpFLSw==","woPDpzPCsAHDlcOUDMOxw75KTcK2Ow==","WcO3w4lJw6HCp8KS","a8OGPiHCkXbCtcOz","bisMw7rCs2xNRjVeGQ==","w4jDvFjDpDk=","w77Cm17Dqx0=","UsK8McK2dw==","R8Kcwokq","w5XDilnDoOaznOWGv+aJieWKrx8=","c8Odw7tfR8KnQxFWY8OG","w6nDgF/Ds1hgLUJbQsKx","ScKXwpsRw7LCnXfCvWc=","w7LDg2vDnDx+wrvDvcKEw4Q7","NMKPwobCksKhM2Z3wrM=","Vx3CtsOV","w47Cm8K1ecKFw61SLh4nwo0=","ZsOFw6FUYQ==","w73DkcK9XSc=","A1vCq8KgFw==","wpbDkhHCsj4=","cHDDg3XDqsOrWEjDvVvDkw==","RcOUw5xxRw==","wrJ/a8KQwojCowd5MQ==","wqjDkCNNw6/DvMOvM8O1KsOz","VcOiw5BKRw==","cgvCksO1wqE=","ZMKGw5zDv00=","wo/DqynClQ==","C1/Dhzs8","SC3CuWAI","TsOLOTLCpw==","BcKeAA1O","fMOxwop4","wpHDvGwTwqhsw6w=","w7rCrGnDrTrCl8OW","CXprbsOyw5rDl8ORHTpCwoY5AQ==","YcOHUMK0","w6nCrWHDrDPCocOGQ8KQw7Yd","wqPDi3kowqY=","PcK5K8Kc","wo7CuVBXw6I=","LVzDrwk6w4hwwotGNMO8","w6jDg1fDg38=","w7LDu1jDhTc=","wrw+eHnCnA==","w6PChcK5c8KT","wqTDlXJqwrM=","e8KFABfDlXfDmsO3VMObQA==","w4XCkcKiTMKbw59FNwg=","KRbDv3Z+aGXCkjByw70=","UCxdP8OcHVc=","UA51G8ON","ZsOAwqRASw==","WMKaOMKo","YcOxwoB5w4E=","wrB0fsKmwpbCpwA=","wpnDj3Jfwr0kEcKXY1fDtw==","w6HCssKySMKI","bcOXw7VRX8KRZBdBZ8OKeA==","wpbDpyrCngDDlMOrCsOBw6lE","TMOqw5hDw6LCrsKfTsOx","bC9ZCMOu","dSTCnsOnwqI=","MMKfwobCosK8JWs=","XhdqLsOpwqMs","V8O5w5Vrw7XCtA==","YcOLNBE=","w4B3PcOLw7I=","SCrCjEkvBMO8","wpLDqyPClBvDosOJAsORw7lY","w5PDpMOrVw==","awZPAMOE","w6LDikjDl1hWNFVQV8KeYFzDtg==","O8KlNsKRwoVp","wozDpi/CsC4=","w7PCrWfDvw==","DULCgFrDnF4=","I8KGwpPCvw==","c8KzM1PDuA==","WDQuwrzCrg==","w5fCh8KzasKgw5BAMw==","wqjCoMO3w7M=","w4l5wq9/","esODLwbChg==","Z8O0woVl","AD9xw6XClsKp","wqd7dsKqwp3CowA=","w7DDi8K6VSQKDyoGw68=","Z8OOwqRObMOnw7kSw5UB","XyHCgEQ3BMOOwqvDlxnCpw==","csKiIMKewpU=","Y8OMMwHCs3LCs8Oq","w5VswqR1","JcKkJMKMwoM=","wrsGYm8=","w73DgGfDjjU=","woLDhDHCscOJwpNyZcOpLw==","wqgCa3HCvhUHw74=","e2DChMKTw4A=","dsKGChfDig==","PMOZUMKkw50lwqQKwrHDjsO/w6ZAw4FRwovDtls=","YsKZBgTDsErDiMOq","wp/Dg3NI","XsKzw7HDuVLDtMO+LA==","f3DDjnLDr8Of","Z8KmPlc=","XcOIFD3CiQ==","w49hwqzCkkw=","aMOyw7VEw6o=","YgvCtVwp","w7PCrhHDgBY=","w57CsxLDoh8=","FFDCql/DkF7DtRM=","dMKFDQLDmEfDmg==","dzJ8EsOE","dsO0wo19w50=","ecKVwrkxw4Q=","TivCg18iAsOs","w7rCkSXDnBNl","UMKcOMKi","HkzCm0fDnFnDpA==","wpFrUMK3wp0=","MsKxMcKZ","JMK1JsKdwo8uwqphQTjDog==","SxdXP8Oq","w7DDnFnDoH1dP18=","wrZ1ccKq","wpzDg3he","P8KiKQBvUlg6wrYSwogxwqA=","w7Fmwr/ClWg=","wo7Dmi9c5rGi5YSj5oqL5YuNwqA=","w6/Cp23DvQ==","woHDrsOnwqgf","Ri9OA8OwC0xyHcOiwrTCm8OM","McKpwrvCgcKX","VxAtwrnCo8KDBg==","BnzCng9jRGHDm8KBTw==","TiXCgUcADcO3wrHDlg==","bzoAw6HCsHo=","wpUyR2vClA==","wpPDkxc=","Shp4DsOe","XSHCiFk=","Q8OPwqVcZA==","dMKFDRg=","Xg1wJA==","W8O5w49t","wqd/fMKhwpPCtAF2D8Kldw==","6YG16K+S5Luh5baY5oyC5paM","wpzDkB8tEw==","PB7Dt394VXY=","wpjDoGcgwoo=","fcOEVg==","w4DDhkXDuGA=","M1LDqA0qw6s=","R8OCw4x0bA==","w7B6J8OFw4Q=","LAvDqXZwVg==","CGrCuD9zRHrDoMKBTzEv","w5dzwrtcwq5KeBjDs1jCmCLDn8K4BA==","B8KdJsKpwqE=","w5NiwpDClmg=","UsK0IcKjfQ==","w6bDrXHDsCg=","VQXClGY7","eMOHORDCimHCs8O8wr59wrI=","wqfCoMO6w7w1bcOmw5BDw5DCsw==","cMO9wpBRw4vDqAzChsOVwplQbCoc","RwMiwprCqMKHBMO+w5I=","w5vDqsO8V8KEw5rDlCrCo2pW","woTDt2gD","wr3CtH1qw4LCh3nChsKb","RwUgwqHCv8Ke","WS3CgE4x","w6nCscK1csKj","DxrDvFpn","w5F/KcOdw4c=","bcOAwrBxw5o=","FC9nw7PCjcK9Ng==","w4dbP8OVw4zDoQ4=","wozDoynClgHDgQ==","JsK8JMKB","RwjCtcOJwqMaAA==","DmHCvx1lUw==","OFLDqgY2w7Vj","w4/DsMKWUTk=","w5ZLJsOew5fDszZewoV3wpE=","w63ChDDDiQ==","w6FzwrLCjWTDksK5","w6bCvcO4w7Q3WcOzw4YLw4HCu8OkwrdFNcOsw7cW","w6rDn1nDvA==","wozDiBEqEw==","DX5zR8O7w40=","wozDiXhOwrMUEQ==","w4VCIsOQw5A=","woPDp0dAwqQ=","aMOOwqlbYcOyw6Q=","w4TDscO+QsKdw7o=","FmLCjx5Q","F8KDwpDClcKj","MxDDuHJ9aGXCgSFmw6M=","w67DgcK0Wz45MjwCw6M4","w5TDqsOxWA==","UMKcOMKic0fCrw==","woPDqMO+wqg=","CXjCnDhk","wpbDpyTClB3Dh8OYB8Oow79M","w6FWworCgnc=","SsOrw55+w4nCqsKcQg==","wpLDjjHCuw==","OsKEwpvCssKfPWZ9wqxqw4HDnFFkAg==","w7nCiSXDkStjf8K9NcOWw59Hw5s=","L8KZAcKTwos=","w6FmLMK4w4vCvlZucg==","Ol3DtR06w6k=","w6rChCjDhA94aw==","ecOtMDnCqQ==","eMOYbsK7w5omwqAB","acONNBs=","ZMKmNUE=","wpPDhzpBw5A=","BmHCpR5MTmvDjMKIeCw8JA4t","wrfDjBVYw6PDi8O+PQ==","GmjCn8KDC3xK","UsKdJcK7c1Y=","CVrChUw=","wpfDs2EdwqF7","Q0XCq8Kvw5l0w6TDtg==","CTTDjVRS","wqZufsKwwo/CsQ==","w7bDjWbDmiVd","TMOsw5p4w7XCtw==","wprCo8OUw7sD","XcKiw7XDv1TDmA==","M2vCpMKaBw==","w7HCrE/DpBc=","wpDDosO1wrQ=","aHbDjXHDtA==","wofDtzPClRvDhsOT","w5lpwrV/wqRJQw==","w6pzwrDChnjDjA==","MMKLwp7CqsK6PGI=","csOHXsK+w5Y=","DGPCoxllbWfDjsKFRxUrJQYh","WFPCmcK2w4R1w5LDrU7DmBHCoA==","wovCjV9Uw4g=","HkLCmUXDkFTDtw==","wpDDq8Oxwr8iw6DDtsK8wrjCoUfCj8OYw5Ew","TRrCi8OAwqkRDsK7wpFy","jCJsrjiaOtGFmVi.com.Rvu6InpJ=="];function o(e,t){e=~~"0x"["concat"](e["slice"](1));var i=r[e];if(void 0===o["fltLGn"]){function n(e,t){var s,i=[],a=0,n="",r="";e=atob(e);for(var o=0,c=e["length"];o<c;o++)r+="%"+("00"+e["charCodeAt"](o)["toString"](16))["slice"](-2);e=decodeURIComponent(r);for(var l=0;l<256;l++)i[l]=l;for(l=0;l<256;l++)a=(a+i[l]+t["charCodeAt"](l%t["length"]))%256,s=i[l],i[l]=i[a],i[a]=s;l=0,a=0;for(var d=0;d<e["length"];d++)l=(l+1)%256,a=(a+i[l])%256,s=i[l],i[l]=i[a],i[a]=s,n+=String["fromCharCode"](e["charCodeAt"](d)^i[(i[l]+i[a])%256]);return n}(function(){var e="undefined"!==typeof window?window:"object"===typeof process&&"object"===typeof s.g?s.g:this,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e["atob"]||(e["atob"]=function(e){for(var s,i,a=String(e)["replace"](/=+$/,""),n=0,r=0,o="";i=a["charAt"](r++);~i&&(s=n%4?64*s+i:i,n++%4)?o+=String["fromCharCode"](255&s>>(-2*n&6)):0)i=t["indexOf"](i);return o})})(),o["fQSKqg"]=n,o["vEhWYI"]={},o["fltLGn"]=!0}var a=o["vEhWYI"][e];return void 0===a?(void 0===o["rnySQs"]&&(o["rnySQs"]=!0),i=o["fQSKqg"](i,t),o["vEhWYI"][e]=i):i=a,i}(function(e,t,s){function i(t,s,i,a,n,r){s>>=8,n="po";var o="shift",c="push";r="‮";if(s<t){while(--t)a=e[o](),s===t&&"‮"===r&&1===r["length"]?(s=a,i=e[n+"p"]()):s&&i["replace"](/[CJrOtGFVRuInpJ=]/g,"")===s&&e[c](a);e[c](e[o]())}return 1181635}i(++t,s)})(r,346,88576),r&&r["length"];var c={name:o("‮0","KRx!"),props:{contact:{type:Object,default:{}},userInfo:{type:Object,default:{}},config:{type:Object,default:{}},alias:{type:String,default:o("‫1","F(Xn")}},data(){return{status:0,peer:null,peers_id:"",localVideo:"",remoteVideo:"",remoteStream:null,localStream:null,calling:null,conn:null,caller:null,is_video:1,isReceived:!1,videoStatus:!0,voiceStatus:!0,cutdown:40,timer:null}},mounted(){this[o("‫2","]9HE")]=this["$refs"][o("‮3","MEVp")],this[o("‫4","Crjo")]=this[o("‫5","7RH(")]["remotevideo"],this[o("‫6","N!PX")]()},methods:{initPeer(){var e={QVpJp:function(e,t){return e+t},MsrsA:"-raingad-peers-id-",WjNHj:o("‫7","9xMY"),OOXwj:function(e,t){return e!==t},zKUhp:"GEFBw",bCIGD:o("‫8","7RH("),wxfDX:"通话服务已关闭",aiwnp:o("‮9","jK07"),MUIhY:o("‮a","tuOA"),Hnbsd:o("‫b","@w^o")};this[o("‮c","jK07")]=e[o("‫d","8kKA")](this[o("‫e","LPBW")],o("‫f","KPal"))+this[o("‫10","LPBW")]["id"],this[o("‮11",")78L")]=new Peer(this[o("‫12","yL$j")],this[o("‫13","5!o3")]),this[o("‮14","f2&B")]["on"](e[o("‫15","N!PX")],(t=>{var s={WVVJy:"calling",AqShy:function(t,s){return e["QVpJp"](t,s)},WgVtD:e[o("‫16","G1cZ")],DqOsg:e[o("‫17","JYH^")]};if(e[o("‮18","Crjo")](e[o("‫19",")7^U")],"GEFBw")){var i={vuIul:s[o("‫1a",")7^U")]};this[o("‮1b","Mmd3")]=is_video,this["caller"]=this[o("‮1c","LPBW")];var a=s[o("‫1d","L3CA")](this[o("‫1e","LS04")],s[o("‮1f","))Df")])+this[o("‮20","Crjo")]["id"];if(this[o("‮21",")7^U")])return!1;this[o("‫22","pUR)")]=this["peer"][o("‫23","Mmd3")](a),this["conn"]["on"](s[o("‫24","F(Xn")],(()=>{this["conn"]["on"](o("‫25","7RH("),(e=>{this[o("‮26","7RH(")](e)}));let e={type:i[o("‮27","6O^^")],userInfo:this[o("‮28","uv@T")],is_video:is_video};this[o("‮29","F(Xn")][o("‮2a",")78L")](e)})),this["initLocalStream"](a,is_video),this[o("‮2b","oo2D")](o("‮2c","G1cZ"))}else console["info"](o("‫2d","Vfh)"),t)})),this[o("‫2e","wpMs")]["on"](e[o("‮2f","*ML3")],(t=>{this[o("‮30","L3CA")](e[o("‮31","cK53")]),this[o("‮32","ut5C")]=t,this[o("‫33","THWW")]=!0,this[o("‮34","Crjo")](),this[o("‮35","g2^9")]=3})),this["peer"]["on"](e[o("‮36","jK07")],(()=>{console[o("‮37","HePr")](e[o("‮38","6O^^")])})),this[o("‫39","Crjo")]["on"](e[o("‫3a","MEVp")],(e=>{this[o("‫3b","LPBW")]=e,this[o("‮3c","6O^^")]["on"](o("‫3d","JYH^"),(e=>{this[o("‮3e","F(Xn")](e)}))}))},callClose(){var e={EiyjT:o("‮3f","THWW"),lrjQN:o("‮40","HePr")};this[o("‮41","UV^T")]["on"](e[o("‫42","7Cpp")],(()=>{console[o("‫43","KPal")](e[o("‮44","uv@T")]),this[o("‫45",")GX5")](!1)}))},initLocalStream(e,t){var s={QMcQG:o("‫46","$sSo"),QpNwe:"KPuvy",aGwok:function(e,t){return e!==t},xAyMx:o("‫47","pUCj"),KEcjJ:function(e,t,s){return e(t,s)},STOeq:o("‮48","UV^T"),gOljs:function(e,t,s,i){return e(t,s,i)}},i=navigator[o("‫49","THWW")]||navigator["webkitGetUserMedia"]||navigator[o("‮4a","9xMY")];s["gOljs"](i,{video:t,audio:!0},(t=>{var i={PegIv:function(e,t){return e!==t},uQbld:s[o("‫4b","7RH(")],zXTmt:s[o("‮4c","G1cZ")],crtqb:function(e,t){return e==t}};s[o("‮4d","pUR)")](s[o("‮4e","tuOA")],s[o("‮4f","Crjo")])?this[o("‫50","N!PX")](data):(this[o("‮51","t&ie")]=this[o("‫52","LS04")](t),this["localVideo"][o("‮53","ut5C")]=this[o("‮54","[Kjs")],e?(this["calling"]=this[o("‮55","7Cpp")]["call"](e,t),this[o("‮56","qOql")](),this[o("‮57","ut5C")]=1,this[o("‮58","Crjo")]=s[o("‮59","jq]Y")](setInterval,(()=>{i[o("‮5a","UV^T")](i[o("‮5b","pUCj")],i[o("‮5c","LS04")])?(this[o("‫5d","KRx!")]--,i["crtqb"](this[o("‮5e","pUCj")],0)&&this[o("‮5f","Lp9Y")](!0)):audio[o("‫60","7RH(")]()}),1e3)):this[o("‫61",")A]@")][o("‮62","THWW")](t),this[o("‫63",")GX5")]["on"](s[o("‫64","]9HE")],(e=>{this["remoteStream"]=e,this[o("‫65","pUCj")]["srcObject"]=e})))}),(function(e){}))},called(e){var t={fwPRd:o("‮66",")7^U"),cDTcz:o("‫67","G1cZ"),rUPSp:function(e,t){return e+t},lAQzv:o("‫68","t&ie"),ymCtP:function(e,t){return e===t},kAeix:"DibSp",GAcUm:o("‫69","uv@T"),yIDkm:o("‫6a","HePr")};this["is_video"]=e,this[o("‮6b","u&9]")]=this[o("‮6c",")78L")];var s=t["rUPSp"](this[o("‮6d","pUCj")],t[o("‮6e",")78L")])+this[o("‫6f","MEVp")]["id"];if(this[o("‫70","[Kjs")]){if(t[o("‫71","THWW")](o("‫72","cK53"),t["kAeix"]))return!1;this[o("‫73","UV^T")]["addTrack"](track),stream[o("‮74","]9HE")](track)}this[o("‫75","[Kjs")]=this["peer"][o("‫76","pUR)")](s),this[o("‮77","*ML3")]["on"](t["GAcUm"],(()=>{this["conn"]["on"](t[o("‮78","THWW")],(e=>{this[o("‮79","Lp9Y")](e)}));let s={type:t[o("‮7a","G1cZ")],userInfo:this[o("‮7b","JYH^")],is_video:e};this["conn"][o("‮7c","@w^o")](s)})),this[o("‮7d","cK53")](s,e),this[o("‮7e",")7^U")](t[o("‫7f","7RH(")])},answer(){var e={sOjLJ:o("‮80","F(Xn"),MxpoZ:o("‫81",")GX5")};if(this[o("‫82",")7^U")]){var t=e[o("‫83","N!PX")]["split"]("|"),s=0;while(1){switch(t[s++]){case"0":this[o("‫70","[Kjs")]=2;continue;case"1":this[o("‫84","KPal")]&&(this["caller"]=null);continue;case"2":this[o("‮85","N!PX")][o("‮86","f2&B")]({type:e[o("‫87","Vfh)")]});continue;case"3":this["playMusicCall"]();continue;case"4":this[o("‫88","THWW")](!1,this[o("‫89","Vfh)")]);continue}break}}},receivedMsg(e){var t={DivGR:o("‫8a","c#4s"),VKVGC:o("‫8b","pUR)")};switch(e[o("‫8c","Mmd3")]){case t["DivGR"]:this[o("‫8d","7Cpp")]=e["userInfo"],this[o("‫8e","8kKA")]=e["is_video"];break;case"hangup":this["hangup"](!1);break;case t[o("‫8f","UV^T")]:this[o("‫90","F(Xn")]=2,clearInterval(this["timer"]),this["playMusicCall"]();break}},hangup(e){var t={gylXM:function(e,t){return e==t},QlMfZ:function(e,t){return e!=t},JbWue:function(e,t){return e!==t},LSXGL:"STdml",UXNRI:function(e,t){return e==t},jmfvR:o("‮91","tuOA")};clearInterval(this["timer"]),this[o("‮92","JYH^")]&&(t[o("‫93","t&ie")](this[o("‫94","yL$j")],2)&&(t[o("‮95","c#4s")](o("‫96","wpMs"),t["LSXGL"])?this["playMusicCall"]():(this["calling"]=this[o("‫97","*ML3")]["call"](call_id,stream),this["callClose"](),this[o("‮21",")7^U")]=1,this[o("‮98","5!o3")]=setInterval((()=>{this[o("‫99","Lp9Y")]--,t["gylXM"](this[o("‮9a","9xMY")],0)&&this[o("‮9b","G1cZ")](!0)}),1e3))),this["status"]=0,this[o("‮9c","cK53")][o("‮9d","KPal")](),this[o("‮9e","THWW")](),this[o("‮9f","8kKA")]=null,t[o("‮a0","qOql")](this[o("‫a1","Mmd3")],null),this[o("‫a2","*ML3")](),this[o("‫a3",")A]@")]=!1,this[o("‮a4","9xMY")]=null),e&&t[o("‫a5","5!o3")](this[o("‮a6","*ML3")],2)&&this["conn"][o("‫a7","c#4s")]({type:t[o("‮a8","jq]Y")]})},getMediaStream(e){var t={VPPYi:function(e,t){return e!==t},aOgza:o("‫a9","MEVp")};return this["localStream"]?e[o("‫aa","Lp9Y")]()[o("‫ab","JYH^")]((t=>{this["localStream"][o("‫ac","N!PX")](t),e[o("‫ad","g2^9")](t)})):t[o("‫ae","tuOA")](o("‮af","wpMs"),t[o("‮b0","pUR)")])?console[o("‮b1","))Df")](o("‮b2","uv@T"),id):this[o("‫b3","$sSo")]=e,this[o("‫b4","uv@T")]},closeLocalMedia(){this[o("‮54","[Kjs")]&&this["localStream"][o("‫b5","))Df")]()&&this[o("‫b6","tuOA")][o("‫b7","cK53")]()["forEach"]((e=>{e[o("‫b8",")A]@")]()})),this[o("‮b9","jq]Y")]=null},switchVoice(){var e={JPHtl:function(e,t){return e===t},VbKPk:o("‫ba","$sSo"),PlAQc:o("‫bb","]9HE"),eiTKK:"DSWII",DicGD:o("‮bc","c#4s"),WYtYb:function(e,t){return e===t},rPVCJ:function(e,t){return e==t},ZfDOl:function(e,t){return e(t)},IIZQA:"请打开音视频"};if(e[o("‮bd","Lp9Y")](this[o("‫be","5!o3")],null))return e[o("‫bf","$sSo")](alert,e["IIZQA"]),!1;const t=this[o("‮54","[Kjs")][o("‫c0","F(Xn")]();this[o("‫c1","Vfh)")]?(t["forEach"]((t=>{if(e[o("‮c2","$sSo")]("ywyjJ",e[o("‮c3",")A]@")]))e[o("‫c4","yL$j")](t[o("‮c5","Lp9Y")],e[o("‫c6",")GX5")])&&(e[o("‫c7","Crjo")]===e[o("‫c8","N!PX")]?e[o("‫c9","oo2D")](t[o("‮ca","LS04")],"audio")&&(t[o("‫cb","7Cpp")]=!1):t[o("‮cc","wpMs")]=!1);else{var s=document[o("‫cd","u&9]")]("music2");s[o("‫ce","KPal")]()}})),this[o("‮cf","wpMs")]=!1):(t["forEach"]((t=>{e[o("‮d0","7Cpp")](t[o("‫d1","7RH(")],e[o("‫d2","qOql")])&&(t[o("‮cc","wpMs")]=!0)})),this[o("‮d3",")GX5")]=!0)},switchVideo(){var e={macoK:function(e,t){return e===t},OGzOm:o("‫d4","uv@T"),QMGBh:o("‮d5","tuOA"),zDAgl:"video",VbhkW:o("‫d6","jK07"),KsdPa:function(e,t){return e(t)},CFdPa:function(e,t){return e===t},lkywi:o("‮d7","jq]Y")};if(null==this["localStream"])return e[o("‮d8",")78L")](alert,"请打开音视频"),!1;const t=this[o("‮d9","LPBW")][o("‫da","jq]Y")]();this[o("‮db","UV^T")]?(t[o("‫dc","L3CA")]((t=>{if(!e["macoK"](e["OGzOm"],o("‮dd","6O^^")))return{status:0,peer:null,peers_id:"",localVideo:"",remoteVideo:"",remoteStream:null,localStream:null,calling:null,conn:null,caller:null,is_video:1,isReceived:!1,videoStatus:!0,voiceStatus:!0,cutdown:40,timer:null};e[o("‫de","MEVp")](t[o("‫df","pUR)")],o("‫e0","LS04"))&&(t[o("‫e1","F(Xn")]=!1)})),this[o("‫e2",")78L")]=!1):e[o("‫e3","jq]Y")](e["lkywi"],"OxbGX")?(this[o("‮e4","$sSo")]=remoteStream,this[o("‫e5","Lp9Y")][o("‫e6","JYH^")]=remoteStream):(t["forEach"]((t=>{var s={rKBkY:"通话服务已关闭"};e[o("‫e7","6O^^")]!==e[o("‮e8",")A]@")]?(this[o("‮e9","cK53")]--,0==this[o("‫ea","6O^^")]&&this[o("‫eb","JYH^")](!0)):t[o("‫ec","N!PX")]===e["zDAgl"]&&(e["macoK"](e["VbhkW"],o("‫ed","pUCj"))?t[o("‮ee","Crjo")]=!0:console["log"](s["rKBkY"]))})),this[o("‮ef","Lp9Y")]=!0)},playMusicCall(e){var t={GJohy:o("‮f0","[Kjs"),yPOad:"calling",hdhAZ:function(e,t){return e===t},dphvh:o("‫f1","6O^^"),lEoid:"JvoAQ"},s=document[o("‮f2","uv@T")](o("‮f3","7RH("));if(t[o("‮f4","Lp9Y")](e,"state")?s["loop"]=!0:s[o("‮f5","wpMs")]=!1,s[o("‫f6","Mmd3")])s[o("‮f7","cK53")]();else if(t[o("‮f8","f2&B")]===t[o("‫f9","ut5C")]){this["conn"]["on"](t["GJohy"],(e=>{this["receivedMsg"](e)}));let e={type:t["yPOad"],userInfo:this[o("‮fa","jq]Y")],is_video:is_video};this[o("‫fb","t&ie")][o("‮fc","9xMY")](e)}else s[o("‫fd","N!PX")]()},playMusicHandup(){var e=document["getElementById"]("music2");e[o("‮fe","LS04")]()}}};n="jsjiami.com.v6";var l=c,d=s(1001),u=(0,d.Z)(l,i,a,!1,null,"333e8dce",null),_=u.exports},9658:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7658),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),vuex__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(3822),_utils_emoji__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(845),_assets_img_login_background_jpg__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3074),_api_im__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1739),_api_login__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2223),_utils_index__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2325),lockr__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4462),lockr__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(lockr__WEBPACK_IMPORTED_MODULE_6__),_components_socket__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(8150),_components_preview__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(9576),_components_chatRecord__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(6959),_components_chatSet__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(9699),_components_chatTop__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(8288),_package_json__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(4147),_components_messageBox_voiceRecorder__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(3943),_components_webrtc__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(8246);const getTime=()=>(new Date).getTime(),user=lockr__WEBPACK_IMPORTED_MODULE_6___default().get("UserInfo");__webpack_exports__["Z"]={name:"app",components:{Socket:_components_socket__WEBPACK_IMPORTED_MODULE_7__.Z,preview:_components_preview__WEBPACK_IMPORTED_MODULE_8__.Z,ChatRecord:_components_chatRecord__WEBPACK_IMPORTED_MODULE_9__.Z,ChatSet:_components_chatSet__WEBPACK_IMPORTED_MODULE_10__.Z,ChatTop:_components_chatTop__WEBPACK_IMPORTED_MODULE_11__.Z,VoiceRecorder:_components_messageBox_voiceRecorder__WEBPACK_IMPORTED_MODULE_13__.Z,webrtc:_components_webrtc__WEBPACK_IMPORTED_MODULE_14__.Z},data(){const e=this.$createElement;var t=this;return{packageData:_package_json__WEBPACK_IMPORTED_MODULE_12__,Background:_assets_img_login_background_jpg__WEBPACK_IMPORTED_MODULE_2__,webrtcConfig:{config:{iceServers:[{urls:"stun:stun.callwithus.com"}]}},componentKey:1,searchResult:!1,createChatBox:!1,addGroupUserBox:!1,forwardBox:!1,noticeBox:!1,messageBox:!1,webrtcBox:!1,groupSetting:!1,VoiceStatus:!1,contactSetting:{},groupUserCount:0,notice:"",createChatTitles:["待选成员","已选成员"],selectUid:[],defaultProps:{key:"user_id",label:"realname",pinyin:"name_py"},contactsProps:{key:"id",label:"realname"},searchList:[],keywords:"",displayName:"",oldName:"",drawer:!1,previewUrl:"",isEdit:!1,settingBox:!1,tabPosition:"left",sendTips:"使用 Enter 键发送消息",setting:{theme:"blue",hideMessageName:!1,hideMessageTime:!1,avatarCricle:!0,sendKey:1,isVoice:!0},user:{id:user.user_id,displayName:user.realname,avatar:user.avatar,account:user.account},height:"640px",pageSize:1,listRows:10,is_group:0,group_id:0,contacts:[],allUser:[],groupUser:[],_beforeUnload_time:0,_gap_time:0,currentChat:{},currentMessage:{},chatTopList:[],playAudio:null,groupMenu:[{text:"发送消息",click:(e,t,s)=>{const{IMUI:i,contact:a}=t;i.changeContact(a.user_id),s()},visible:e=>e.contact.user_id!=this.user.id},{text:"设置管理员",click:(e,t,s)=>{const{IMUI:i,contact:a}=t;s(),this.$confirm("确定设置该成员为管理员吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.nW)({id:this.group_id,user_id:a.user_id,role:2}),this.$message({type:"success",message:"设置成功!"})}))},visible:e=>3==e.contact.role&&this.currentChat.owner_id==this.user.id},{text:"取消管理员",click:(e,t,s)=>{const{IMUI:i,contact:a}=t;s(),this.$confirm("确定取消该成员的管理员权限吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.nW)({id:this.group_id,user_id:a.user_id,role:3}),this.$message({type:"success",message:"取消成功!"})}))},visible:e=>2==e.contact.role&&this.currentChat.owner_id==this.user.id},{text:"移出群聊",color:"red",click:(e,t,s)=>{const{IMUI:i,contact:a}=t;s(),this.$confirm("确定移除该成员吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.R)({id:this.group_id,user_id:a.user_id})}))},visible:e=>e.contact.user_id!=this.user.id&&this.currentChat.owner_id!=e.contact.user_id&&this.currentChat.role<=2}],contactContextmenu:[{icon:"el-icon-upload2",text:"置顶聊天",click:(e,t,s)=>{const{IMUI:i,contact:a}=t;(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.fF)({id:a.id,is_top:1,is_group:a.is_group}).then((e=>{0==e.code&&(i.updateContact({id:a.id,is_top:1}),a.is_top=1,this.chatTopList.push(a))})),s()},visible:e=>0==e.contact.is_top},{icon:"el-icon-download",text:"取消置顶",click:(e,t,s)=>{const{IMUI:i,contact:a}=t;(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.fF)({id:a.id,is_top:0,is_group:a.is_group}).then((e=>{0==e.code&&(i.updateContact({id:a.id,is_top:0}),(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.pH)(this.chatTopList,"id",a.id))})),s()},visible:e=>1==e.contact.is_top},{click(e,t,s){const{IMUI:i,contact:a}=t;s(),(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.q3)({id:a.id,is_notice:0,is_group:a.is_group}),i.updateContact({id:a.id,is_notice:0})},icon:"el-icon-bell",text:"消息免打扰",visible:e=>1==e.contact.is_notice},{click(e,t,s){const{IMUI:i,contact:a}=t;s(),(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.q3)({id:a.id,is_notice:1,is_group:a.is_group}),i.updateContact({id:a.id,is_notice:1})},icon:"el-icon-close-notification",text:"取消免打扰",visible:e=>0==e.contact.is_notice},{click(e,s,i){const{IMUI:a,contact:n}=s;i(),t.groupSetting=!0,t.contactSetting=n,t.componentKey++},icon:"el-icon-setting",text:"群管理",visible:e=>1==e.contact.role&&1==e.contact.is_group},{click(e,s,i){const{IMUI:a,contact:n}=s;i(),t.$confirm("确定删除该群聊吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.eF)({id:n.id}),t.$message({type:"success",message:"删除成功!"})}))},icon:"el-icon-delete",color:"red",text:"删除群聊",visible:e=>e.contact.owner_id==t.user.id&&1==e.contact.is_group},{click(e,s,i){const{IMUI:a,contact:n}=s;i(),t.$confirm("确定退出该群聊吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.R)({id:n.id,user_id:t.user.id}),t.$message({type:"success",message:"退出成功!"})}))},icon:"el-icon-remove-outline",color:"red",text:"退出群聊",visible:e=>e.contact.owner_id!=t.user.id&&1==e.contact.is_group}],contextmenu:[{click:(t,s,i)=>{const{IMUI:a,message:n}=s;(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.Cj)({id:n.id}).then((t=>{const s={id:n.id,type:"event",content:e("div",[e("span",["你撤回了一条消息"," ",e("span",{directives:[{name:"show",value:"text"==n.type}],style:"color:#409EFF;cursor:pointer",attrs:{content:n.content},on:{click:e=>{a.setEditorValue(e.target.getAttribute("content"))}}},["重新编辑"])])]),toContactId:n.toContactId,sendTime:getTime()};a.updateMessage(s)})).catch((e=>{this.$message.error("发生错误")})),i()},visible:e=>e.message.fromUser.id==this.user.id&&getTime()-e.message.sendTime<12e4,text:"撤回消息"},{text:"转发",click:(e,t,s)=>{this.currentMessage=t.message;const{IMUI:i}=this.$refs,a=i.getContacts(),n=i.getCurrentContact();this.allUser=(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.L4)(a,"id",n.id),s(),this.forwardBox=!0}},{visible:e=>"text"==e.message.type,text:"复制文字",click:(e,t,s)=>{this.$clipboard(t.message.content),this.$message({type:"success",message:"复制成功!"}),s()}},{visible:e=>"image"==e.message.type,text:"下载图片",click:(e,t,s)=>{const{message:i}=t;this.download(i.content,i.fileName,i.type),s()}},{visible:e=>"file"==e.message.type,text:"下载文件",click:(e,t,s)=>{const{message:i}=t;this.download(i.content,i.fileName,i.type),s()}}]}},computed:{...(0,vuex__WEBPACK_IMPORTED_MODULE_15__.rn)({socketAction:e=>e.socketAction}),formatTime(){return function(e){return(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.i$)(e)}}},watch:{playAudio(e){if(e&&this.currentMessage){let e=this.currentMessage;var t=this;const{IMUI:s}=this.$refs;this.playAudio.addEventListener("ended",(function(){console.log("声音停止"),t.playAudio=null,t.currentMessage=null,s.updateMessage({id:e.id,status:"successd",isPlay:0})}),!1)}},keywords(){const{IMUI:e}=this.$refs,t=e.getContacts();this.searchContact(t)},"setting.sendKey"(e){this.sendTips=1==e?"使用 Enter 键发送消息":"使用 Ctrl + Enter 键发送消息"},setting:{handler(e,t){(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.py)(e),user.setting=e,lockr__WEBPACK_IMPORTED_MODULE_6___default().set("UserInfo",user)},deep:!0},socketAction(e){const t=this.$createElement;let s=e.data;const{IMUI:i}=this.$refs;let a=lockr__WEBPACK_IMPORTED_MODULE_6___default().get("client_id");switch(e.type){case"isOnline":i.updateContact({id:s.id,is_online:s.is_online});break;case"offline":s.id!=this.user.id||s.client_id==a||s.isMobile||(this.$message.error="您的账号在其他地方登录，已被迫下线！",this.$store.dispatch("LogOut").then((()=>{this.$router.push({path:"/login"})})));break;case"simple":case"group":if(s.fromUser.id!=this.user.id){var n=this.getContact(s.toContactId);this.setting.isVoice&&1==n.is_notice&&this.popNotice(s)}this.recieveMsg(s);break;case"undoMessage":i.updateMessage(s);break;case"editGroupName":i.updateContact({id:s.id,displayName:s.displayName});const e={id:(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.NW)(),type:"event",content:t("div",[t("span",[s.editUserName," 修改了群名为 ",s.displayName])]),toContactId:s.id,sendTime:getTime()};i.appendMessage(e,!0);break;case"isRead":this.setLocalMsgIsRead(s);break;case"addGroup":s.owner_id!=this.user.id&&i.appendContact(s),(0,_api_login__WEBPACK_IMPORTED_MODULE_4__.zQ)({client_id:a,group_id:s.id});break;case"setManager":case"addGroupUser":case"removeUser":s.group_id==this.group_id&&this.getGroupUserList(s.group_id);break;case"removeGroup":i.removeContact(s.group_id),i.currentContactId==s.group_id&&i.changeContact(null);break;case"setNotice":i.updateContact({id:s.group_id,notice:s.notice}),i.appendMessage({id:(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.NW)(),type:"event",content:t("div",[t("span",["管理员 发布了公告： ",s.notice])]),toContactId:s.group_id,sendTime:getTime()},!0);break;case"groupSetting":i.updateContact({id:s.group_id,setting:s.setting})}}},created(){user.setting&&(this.setting=eval(user.setting)),window.Notification?"granted"==Notification.permission?console.log("允许通知"):"denied"!=Notification.permission&&(console.log("需要通知权限"),Notification.requestPermission((e=>{}))):console.error("浏览器不支持Notification")},mounted(){this.searchResult&&document.addEventListener("click",(function(e){that.$refs.configforms.contains(e.target)||(that.searchResult=!1)})),this.getSimpleChat()},methods:{called(e){this.webrtcBox=!0,this.$refs.webrtc.called(e)},getSimpleChat(){const e=this.$createElement,{IMUI:t}=this.$refs;this.IMUI=t,t.setLastContentRender("voice",(e=>"[语音]")),t.setLastContentRender("video",(e=>"[视频]")),(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.BN)().then((e=>{const s=e.data;this.contacts=s;var i={};s.forEach(((e,a)=>{e.type&&(i.type=e.type,i.content=e.lastContent,s[a]["lastContent"]=t.lastContentRender(i))})),this.getChatTop(s),t.initContacts(s)})),t.initMenus([{name:"messages"},{name:"contacts"},{name:"kaiyuan",title:"开源",unread:0,click:()=>{window.open(this.packageData.frontUrl)},render:t=>e("i",{class:"el-icon-connection"})},{name:"mobile",title:"移动端体验",unread:0,click:()=>{window.open("https://im.raingad.com/web")},render:t=>e("i",{class:"el-icon-mobile-phone"})},{name:"custom2",title:"系统设置",unread:0,click:()=>{this.settingBox=!0},render:t=>e("i",{class:"el-icon-setting"}),isBottom:!0}]),t.initEditorTools([{name:"emoji"},{name:"uploadImage",title:"发送图片"},{name:"sendVoice",title:"发送语音",click:()=>{this.VoiceStatus=!0},render:()=>e("i",{class:"el-icon el-icon-microphone f-18",style:"vertical-align: middle;font-weight: 600;"})},{name:"uploadVideo",title:"发送视频",click:()=>{var e=this.$refs.uploadVideo;e.click()},render:()=>e("i",{class:"el-icon el-icon-video-play f-18",style:"vertical-align: middle;font-weight: 600;"},[e("input",{style:"display:none",attrs:{type:"file",accept:"video/*"},ref:"uploadVideo",on:{change:e=>{this.uploadVideo(e)}}})])},{name:"uploadFile",title:"发送文件"}]),t.initEmoji(_utils_emoji__WEBPACK_IMPORTED_MODULE_1__.Z)},getChatTop(){for(var e=this.contacts,t=[],s=0;s<e.length;s++)1==e[s].is_top&&t.push(e[s]);this.chatTopList=t},getContact(e){const{IMUI:t}=this.$refs,s=t.getContacts();for(var i=0;i<s.length;i++)if(s[i].id==e)return s[i]},wrapKey(e){return 1==this.setting.sendKey?13==e.keyCode&&e.ctrlKey:13==e.keyCode&&!e.ctrlKey&&!e.shiftKey},setSendKey(e){return 1==this.setting.sendKey?13==e.keyCode&&!e.ctrlKey&&!e.shiftKey:13==e.keyCode&&e.ctrlKey},handleMessageClick(e,t,s,i){if("status"==t)return i.updateMessage({id:s.id,status:"going",content:"这个功能没做"}),void setTimeout((()=>{i.updateMessage({id:s.id,status:"failed",content:"还是发送失败，哈哈哈哈！！！"})}),2e3);if("voice"==s.type){if(!this.playAudio)return this.currentMessage=s,this.playVoice(s,i);this.playAudio.pause(),this.playAudio=null,i.updateMessage({id:this.currentMessage.id,status:"successd",isPlay:0}),s.id!=this.currentMessage.id&&(this.currentMessage=s,this.playVoice(s,i))}var a=["image","file","video"];if(a.includes(s.type)){if(!s.preview)return this.$message.error("没有配置预览接口");this.previewUrl=s.preview,this.drawer=!0}},playVoice(e,t){this.playAudio=new Audio(e.content),this.playAudio.play(),t.updateMessage({id:e.id,status:"succeed",isPlay:1})},openChat(e,t){this.keywords="",t.changeContact(e)},handleChangeContact(e,t){t.updateContact({id:e.id,unread:0}),this.pageSize=1,this.displayName=e.displayName,this.oldName=e.displayName,this.currentChat=e,1==e.is_group&&this.group_id!=e.id&&this.getGroupUserList(e.id),this.is_group=e.is_group,1==this.is_group&&(this.group_id=e.id,this.notice=e.notice);var s=[];const{IMUI:i}=this.$refs;for(var a=i.getMessages(e.id),n=0;a.length>n;n++)0==a[n].is_read&&a[n].fromUser.id!=this.user.id&&s.push(a[n]);s.length>0&&(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.$M)({is_group:e.is_group,toContactId:e.id,messages:s,fromUser:e.id}).then((e=>{0==e.code&&this.setLocalMsgIsRead(s)})),t.closeDrawer()},uploadVideo(e){let t,s=e.srcElement.files[0],i=URL.createObjectURL(s),a=new Audio(i);a.addEventListener("loadedmetadata",(function(e){t=a.duration}));let n={content:i,fromUser:this.user,id:(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.NW)(),sendTime:getTime(),status:"going",toContactId:this.currentChat.id,type:"video",extends:{duration:t}};this.diySendMessage(n,s),this.$refs.uploadVideo.value=""},sendVoice(e,t){let s={content:URL.createObjectURL(t),fromUser:this.user,id:(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.NW)(),sendTime:getTime(),status:"going",toContactId:this.currentChat.id,type:"voice",isPlay:0,extends:{duration:e}};this.VoiceStatus=!1,this.diySendMessage(s,t)},diySendMessage(e,t){const{IMUI:s}=this.$refs;s.appendMessage(e,!0),this.handleSend(e,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{status:"succeed"};s.updateContact({id:e.toContactId,lastContent:s.lastContentRender(e),lastSendTime:e.sendTime}),s.CacheDraft.remove(e.toContactId),s.updateMessage(Object.assign(e,t))}),t)},handleSend(e,t,s){let i=new FormData;e.is_group=this.is_group;const{IMUI:a}=this.$refs;if(s){if(s.size>5242880)return a.removeMessage(e.id),this.$message.error("上传的内容不等大于5MB！");i.append("file",s),i.append("message",JSON.stringify(e)),(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.W0)(i).then((e=>{a.updateMessage(e.data),t()})).catch((s=>{401==s.code?a.removeMessage(e.id):t({status:"failed"})}))}else(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.pi)(e).then((e=>{a.setEditorValue(""),a.updateMessage(e.data),t()})).catch((s=>{401==s.code?a.removeMessage(e.id):t({status:"failed"})}))},handlePullMessages(e,t,s){return(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.lX)({toContactId:e.id,is_group:e.is_group,pageSize:this.pageSize,listRows:this.listRows}).then((e=>{this.pageSize++;let s=!1,i=e.data;i.length<this.listRows&&(s=!0),t(i,s)})).catch((e=>{t([],!0)})),!0},publishNotice(){this.noticeBox=!1,(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.qj)({id:this.group_id,notice:this.notice}).then((e=>{0==e.code&&this.$message({type:"success",message:"发布成功!"})}))},openNotice(){var e="<div style='white-space: pre;'>"+this.notice+"</div>";this.$alert(e,"群公告",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0})},getAllUser(e){(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.xt)(e).then((e=>{const t=e.data;this.allUser=t}))},openCreateGroup(){this.getAllUser({}),this.createChatBox=!0},openAddGroupUser(){var e=(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.Nj)(this.groupUser,"user_id");this.getAllUser({user_ids:e}),this.addGroupUserBox=!0},fn(e){return new Promise(((t,s)=>{(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.pi)(e).then((e=>{0===e.code?t(e):this.$message.error(e.msg)})).catch((e=>{}))}))},async test(e){let t=await this.fn(e);return t},forwardUser(){var e=this.selectUid;if(this.selectUid=[],e.length>5)return this.$message.error("转发的人数不能超过5人！");this.forwardBox=!1;for(var t=this.currentMessage,s=[],i=0;i<e.length;i++){var a=e[i].toString();t.id=(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.NW)(),t.status="successd",t.sendTime=getTime(),t.toContactId=a,t.fromUser=this.user,t.is_group=0,-1!=a.indexOf("group")&&(t.is_group=1),s.push(this.test(t))}Promise.all(s).then((e=>{const{IMUI:t}=this.$refs;for(var s=0;s<e.length;s++){var i=e[s].data;0==i.is_group&&(i.toContactId=parseInt(i.toContactId)),t.appendMessage(i),t.updateContact({id:i.toContactId,unread:0})}})).catch((e=>{console.log("error",e)}))},addGroupUser(){this.addGroupUserBox=!1,(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.R7)({user_ids:this.selectUid,id:this.group_id}),this.selectUid=[]},createGroup(){this.createChatBox=!1,(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.NQ)({user_ids:this.selectUid}).then((e=>{const t=e.data,{IMUI:s}=this.$refs;0==e.code&&(s.appendContact(t),s.changeContact(t.id)),this.selectUid=[]}))},getGroupUserList(e){(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.O2)({group_id:e}).then((e=>{if(0==e.code){var t=e.data;this.groupUser=t,this.groupUserCount=t.length}}))},saveGroupName(e){if(this.displayName.length<1)return this.$notify({title:"警告",message:"名称不能为空！",type:"warning"}),this.isEdit=!1,!1;if(this.displayName!=this.oldName){const{IMUI:t}=this.$refs;(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.ey)({id:e.id,displayName:this.displayName}).then((s=>{t.updateContact({id:e.id,displayName:this.displayName})}))}this.isEdit=!1},closeSearch(){var e=this;setTimeout((function(){e.searchResult=!1}),300)},searchContact(e){""!=this.keywords&&(this.searchList=(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.iu)(e,["displayName","name_py"],this.keywords))},setLocalMsgIsRead(e){const{IMUI:t}=this.$refs;for(let s=0;e.length>s;s++){const i={id:e[s]["id"],is_read:1,status:"succeed",content:e[s]["content"]+" "};t.updateMessage(i)}},download(e,t,s){let i=document.createElement("a");i.download="image"==s?t||"pic":t||"file",i.href=e,i.click()},popNotice(e){let t=this;if("granted"==Notification.permission){let s=new Notification("收到一条新消息",{body:e.fromUser.displayName+"："+e.content,icon:e.fromUser.avatar});s.onclick=function(e){t.$nextTick((()=>{setTimeout((()=>{}),500)})),window.focus(),s.close()},console.log("浏览器通知！")}else{console.log("声音通知！");const e=document.getElementById("chatAudio");e.currentTime=0,e.play()}},recieveMsg(e){const{IMUI:t}=this.$refs,s=t.getCurrentContact();if(s.id==e.toContactId){var i=[];i.push(e),(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.$M)({toContactId:s.id,is_group:s.is_group,messages:i,fromUser:e.fromUser.id})}this.user.id==e.toContactId&&(e.toContactId=e.toUser),t.appendMessage(e,!0)},openGallery(){this.$message({message:"即将呈现！",type:"warning"})},openMessageBox(){this.messageBox=!0,this.componentKey+=1},changeDrawer(e,t){const s=this.$createElement;t.changeDrawer({offsetX:0,offsetY:1,render:()=>s("div",{class:"drawer-content"},[s("p",[s("b",["自定义抽屉"])]),s("p",[e.displayName])])})},logout(){this.$confirm("你确定要退出聊天室吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$store.dispatch("LogOut").then((()=>{this.$router.push({path:"/login"})}))})).catch((()=>{this.$message({type:"info",message:"已取消退出"})}))}}}},2936:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7658),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),vuex__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(3822),_utils_emoji__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(845),_assets_img_login_background_jpg__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3074),_api_im__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1739),_api_login__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2223),_utils_index__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2325),lockr__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4462),lockr__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(lockr__WEBPACK_IMPORTED_MODULE_6__),_components_socket__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(8150),_components_preview__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(9576),_components_chatRecord__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(6959),_components_chatSet__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(9699),_components_chatTop__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(8288),_package_json__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(4147),_components_messageBox_voiceRecorder__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(3943),_components_webrtc__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(8246);const getTime=()=>(new Date).getTime(),user=lockr__WEBPACK_IMPORTED_MODULE_6___default().get("UserInfo");__webpack_exports__["Z"]={name:"app",components:{Socket:_components_socket__WEBPACK_IMPORTED_MODULE_7__.Z,preview:_components_preview__WEBPACK_IMPORTED_MODULE_8__.Z,ChatRecord:_components_chatRecord__WEBPACK_IMPORTED_MODULE_9__.Z,ChatSet:_components_chatSet__WEBPACK_IMPORTED_MODULE_10__.Z,ChatTop:_components_chatTop__WEBPACK_IMPORTED_MODULE_11__.Z,VoiceRecorder:_components_messageBox_voiceRecorder__WEBPACK_IMPORTED_MODULE_13__.Z,webrtc:_components_webrtc__WEBPACK_IMPORTED_MODULE_14__.Z},props:{dialogTableVisible:{type:Boolean,default:!1}},data(){const e=this.$createElement;var t=this;return{unread:0,dialogIsShow:!0,packageData:_package_json__WEBPACK_IMPORTED_MODULE_12__,Background:_assets_img_login_background_jpg__WEBPACK_IMPORTED_MODULE_2__,webrtcConfig:{config:{iceServers:[{urls:"stun:stun.callwithus.com"}]}},componentKey:1,searchResult:!1,createChatBox:!1,addGroupUserBox:!1,forwardBox:!1,noticeBox:!1,messageBox:!1,webrtcBox:!1,groupSetting:!1,VoiceStatus:!1,contactSetting:{},groupUserCount:0,notice:"",createChatTitles:["待选成员","已选成员"],selectUid:[],defaultProps:{key:"user_id",label:"realname",pinyin:"name_py"},contactsProps:{key:"id",label:"realname"},searchList:[],keywords:"",displayName:"",oldName:"",drawer:!1,previewUrl:"",isEdit:!1,settingBox:!1,tabPosition:"left",sendTips:"使用 Enter 键发送消息",setting:{theme:"blue",hideMessageName:!1,hideMessageTime:!1,avatarCricle:!0,sendKey:1,isVoice:!0},user:{id:user.user_id,displayName:user.realname,avatar:user.avatar,account:user.account},height:"640px",pageSize:1,listRows:10,is_group:0,group_id:0,contacts:[],allUser:[],groupUser:[],_beforeUnload_time:0,_gap_time:0,currentChat:{},currentMessage:{},chatTopList:[],playAudio:null,groupMenu:[{text:"发送消息",click:(e,t,s)=>{const{IMUI:i,contact:a}=t;i.changeContact(a.user_id),s()},visible:e=>e.contact.user_id!=this.user.id},{text:"设置管理员",click:(e,t,s)=>{const{IMUI:i,contact:a}=t;s(),this.$confirm("确定设置该成员为管理员吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.nW)({id:this.group_id,user_id:a.user_id,role:2}),this.$message({type:"success",message:"设置成功!"})}))},visible:e=>3==e.contact.role&&this.currentChat.owner_id==this.user.id},{text:"取消管理员",click:(e,t,s)=>{const{IMUI:i,contact:a}=t;s(),this.$confirm("确定取消该成员的管理员权限吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.nW)({id:this.group_id,user_id:a.user_id,role:3}),this.$message({type:"success",message:"取消成功!"})}))},visible:e=>2==e.contact.role&&this.currentChat.owner_id==this.user.id},{text:"移出群聊",color:"red",click:(e,t,s)=>{const{IMUI:i,contact:a}=t;s(),this.$confirm("确定移除该成员吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.R)({id:this.group_id,user_id:a.user_id})}))},visible:e=>e.contact.user_id!=this.user.id&&this.currentChat.owner_id!=e.contact.user_id&&this.currentChat.role<=2}],contactContextmenu:[{icon:"el-icon-upload2",text:"置顶聊天",click:(e,t,s)=>{const{IMUI:i,contact:a}=t;(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.fF)({id:a.id,is_top:1,is_group:a.is_group}).then((e=>{0==e.code&&(i.updateContact({id:a.id,is_top:1}),a.is_top=1,this.chatTopList.push(a))})),s()},visible:e=>0==e.contact.is_top},{icon:"el-icon-download",text:"取消置顶",click:(e,t,s)=>{const{IMUI:i,contact:a}=t;(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.fF)({id:a.id,is_top:0,is_group:a.is_group}).then((e=>{0==e.code&&(i.updateContact({id:a.id,is_top:0}),(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.pH)(this.chatTopList,"id",a.id))})),s()},visible:e=>1==e.contact.is_top},{click(e,t,s){const{IMUI:i,contact:a}=t;s(),(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.q3)({id:a.id,is_notice:0,is_group:a.is_group}),i.updateContact({id:a.id,is_notice:0})},icon:"el-icon-bell",text:"消息免打扰",visible:e=>1==e.contact.is_notice},{click(e,t,s){const{IMUI:i,contact:a}=t;s(),(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.q3)({id:a.id,is_notice:1,is_group:a.is_group}),i.updateContact({id:a.id,is_notice:1})},icon:"el-icon-close-notification",text:"取消免打扰",visible:e=>0==e.contact.is_notice},{click(e,s,i){const{IMUI:a,contact:n}=s;i(),t.groupSetting=!0,t.contactSetting=n,t.componentKey++},icon:"el-icon-setting",text:"群管理",visible:e=>1==e.contact.role&&1==e.contact.is_group},{click(e,s,i){const{IMUI:a,contact:n}=s;i(),t.$confirm("确定删除该群聊吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.eF)({id:n.id}),t.$message({type:"success",message:"删除成功!"})}))},icon:"el-icon-delete",color:"red",text:"删除群聊",visible:e=>e.contact.owner_id==t.user.id&&1==e.contact.is_group},{click(e,s,i){const{IMUI:a,contact:n}=s;i(),t.$confirm("确定退出该群聊吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.R)({id:n.id,user_id:t.user.id}),t.$message({type:"success",message:"退出成功!"})}))},icon:"el-icon-remove-outline",color:"red",text:"退出群聊",visible:e=>e.contact.owner_id!=t.user.id&&1==e.contact.is_group}],contextmenu:[{click:(t,s,i)=>{const{IMUI:a,message:n}=s;(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.Cj)({id:n.id}).then((t=>{const s={id:n.id,type:"event",content:e("div",[e("span",["你撤回了一条消息"," ",e("span",{directives:[{name:"show",value:"text"==n.type}],style:"color:#409EFF;cursor:pointer",attrs:{content:n.content},on:{click:e=>{a.setEditorValue(e.target.getAttribute("content"))}}},["重新编辑"])])]),toContactId:n.toContactId,sendTime:getTime()};a.updateMessage(s)})).catch((e=>{this.$message.error("发生错误")})),i()},visible:e=>e.message.fromUser.id==this.user.id&&getTime()-e.message.sendTime<12e4,text:"撤回消息"},{text:"转发",click:(e,t,s)=>{this.currentMessage=t.message;const{IMUI:i}=this.$refs,a=i.getContacts(),n=i.getCurrentContact();this.allUser=(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.L4)(a,"id",n.id),s(),this.forwardBox=!0}},{visible:e=>"text"==e.message.type,text:"复制文字",click:(e,t,s)=>{this.$clipboard(t.message.content),this.$message({type:"success",message:"复制成功!"}),s()}},{visible:e=>"image"==e.message.type,text:"下载图片",click:(e,t,s)=>{const{message:i}=t;this.download(i.content,i.fileName,i.type),s()}},{visible:e=>"file"==e.message.type,text:"下载文件",click:(e,t,s)=>{const{message:i}=t;this.download(i.content,i.fileName,i.type),s()}}]}},computed:{...(0,vuex__WEBPACK_IMPORTED_MODULE_15__.rn)({socketAction:e=>e.socketAction,contactId:e=>e.toContactId,contactSync:e=>e.contactSync}),formatTime(){return function(e){return(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.i$)(e)}}},watch:{playAudio(e){if(e&&this.currentMessage){let e=this.currentMessage;var t=this;const{IMUI:s}=this.$refs;this.playAudio.addEventListener("ended",(function(){console.log("声音停止"),t.playAudio=null,t.currentMessage=null,s.updateMessage({id:e.id,status:"successd",isPlay:0})}),!1)}},contactSync(e){this.dialogIsShow=!0,this.$emit("update:dialogTableVisible",!0);const{IMUI:t}=this.$refs;t.changeContact(this.contactId)},unread(e){this.$store.commit("updateUnread",e)},dialogTableVisible(e){e&&(this.$nextTick((()=>{this.dialogIsShow=e})),this.getSimpleChat("update"))},keywords(){const{IMUI:e}=this.$refs,t=e.getContacts();this.searchContact(t)},"setting.sendKey"(e){this.sendTips=1==e?"使用 Enter 键发送消息":"使用 Ctrl + Enter 键发送消息"},setting:{handler(e,t){(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.py)(e),user.setting=e,lockr__WEBPACK_IMPORTED_MODULE_6___default().set("UserInfo",user)},deep:!0},socketAction(e){const t=this.$createElement;let s=e.data;const{IMUI:i}=this.$refs;let a=lockr__WEBPACK_IMPORTED_MODULE_6___default().get("client_id");switch(e.type){case"isOnline":i.updateContact({id:s.id,is_online:s.is_online});break;case"offline":s.id!=this.user.id||s.client_id==a||s.isMobile||(this.$message.error="您的账号在其他地方登录，已被迫下线！",this.$store.dispatch("LogOut").then((()=>{this.$router.push({path:"/login"})})));break;case"simple":case"group":if(s.fromUser.id!=this.user.id){var n=this.getContact(s.toContactId);this.setting.isVoice&&1==n.is_notice&&this.popNotice(s)}this.recieveMsg(s);break;case"undoMessage":i.updateMessage(s);break;case"editGroupName":i.updateContact({id:s.id,displayName:s.displayName});const e={id:(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.NW)(),type:"event",content:t("div",[t("span",[s.editUserName," 修改了群名为 ",s.displayName])]),toContactId:s.id,sendTime:getTime()};i.appendMessage(e,!0);break;case"isRead":this.setLocalMsgIsRead(s);break;case"addGroup":s.owner_id!=this.user.id&&i.appendContact(s),(0,_api_login__WEBPACK_IMPORTED_MODULE_4__.zQ)({client_id:a,group_id:s.id});break;case"setManager":case"addGroupUser":case"removeUser":s.group_id==this.group_id&&this.getGroupUserList(s.group_id);break;case"removeGroup":i.removeContact(s.group_id),i.currentContactId==s.group_id&&i.changeContact(null);break;case"setNotice":i.updateContact({id:s.group_id,notice:s.notice}),i.appendMessage({id:(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.NW)(),type:"event",content:t("div",[t("span",["管理员 发布了公告： ",s.notice])]),toContactId:s.group_id,sendTime:getTime()},!0);break;case"groupSetting":i.updateContact({id:s.group_id,setting:s.setting})}}},created(){user.setting&&(this.setting=eval(user.setting)),window.Notification?"granted"==Notification.permission?console.log("允许通知"):"denied"!=Notification.permission&&(console.log("需要通知权限"),Notification.requestPermission((e=>{}))):console.error("浏览器不支持Notification")},mounted(){this.searchResult&&document.addEventListener("click",(function(e){that.$refs.configforms.contains(e.target)||(that.searchResult=!1)})),this.getSimpleChat()},methods:{closeDialog(){this.appList=!1,this.$nextTick((()=>{this.$emit("update:dialogTableVisible",!1)}))},called(e){this.webrtcBox=!0,this.$refs.webrtc.called(e)},getSimpleChat(e){const t=this.$createElement;this.$nextTick((()=>{const s=this.$refs.IMUI;this.IMUI=s,s.setLastContentRender("voice",(e=>"[语音]")),s.setLastContentRender("video",(e=>"[视频]")),(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.BN)().then((t=>{const i=t.data;this.contacts=i;var a={};i.forEach(((t,n)=>{t.type&&(a.type=t.type,a.content=t.lastContent,i[n]["lastContent"]=s.lastContentRender(a)),t.unread&&!e&&(this.unread+=t.unread)})),this.$store.commit("initContacts",i),this.getChatTop(i),s.initContacts(i)})),s.initMenus([{name:"messages"},{name:"contacts"},{name:"kaiyuan",title:"开源",unread:0,click:()=>{window.open(this.packageData.frontUrl)},render:e=>t("i",{class:"el-icon-connection"})},{name:"mobile",title:"移动端体验",unread:0,click:()=>{window.open("https://im.raingad.com/web")},render:e=>t("i",{class:"el-icon-mobile-phone"})},{name:"custom2",title:"系统设置",unread:0,click:()=>{this.settingBox=!0},render:e=>t("i",{class:"el-icon-setting"}),isBottom:!0}]),s.initEditorTools([{name:"emoji"},{name:"uploadImage",title:"发送图片"},{name:"sendVoice",title:"发送语音",click:()=>{this.VoiceStatus=!0},render:()=>t("i",{class:"el-icon el-icon-microphone f-18",style:"vertical-align: middle;font-weight: 600;"})},{name:"uploadVideo",title:"发送视频",click:()=>{var e=this.$refs.uploadVideo;e.click()},render:()=>t("i",{class:"el-icon el-icon-video-play f-18",style:"vertical-align: middle;font-weight: 600;"},[t("input",{style:"display:none",attrs:{type:"file",accept:"video/*"},ref:"uploadVideo",on:{change:e=>{this.uploadVideo(e)}}})])},{name:"uploadFile",title:"发送文件"}]),s.initEmoji(_utils_emoji__WEBPACK_IMPORTED_MODULE_1__.Z)}))},getChatTop(){for(var e=this.contacts,t=[],s=0;s<e.length;s++)1==e[s].is_top&&t.push(e[s]);this.chatTopList=t},getContact(e){const{IMUI:t}=this.$refs,s=t.getContacts();for(var i=0;i<s.length;i++)if(s[i].id==e)return s[i]},wrapKey(e){return 1==this.setting.sendKey?13==e.keyCode&&e.ctrlKey:13==e.keyCode&&!e.ctrlKey&&!e.shiftKey},setSendKey(e){return 1==this.setting.sendKey?13==e.keyCode&&!e.ctrlKey&&!e.shiftKey:13==e.keyCode&&e.ctrlKey},handleMessageClick(e,t,s,i){if("status"==t)return i.updateMessage({id:s.id,status:"going",content:"这个功能没做"}),void setTimeout((()=>{i.updateMessage({id:s.id,status:"failed",content:"还是发送失败，哈哈哈哈！！！"})}),2e3);if("voice"==s.type){if(!this.playAudio)return this.currentMessage=s,this.playVoice(s,i);this.playAudio.pause(),this.playAudio=null,i.updateMessage({id:this.currentMessage.id,status:"successd",isPlay:0}),s.id!=this.currentMessage.id&&(this.currentMessage=s,this.playVoice(s,i))}var a=["image","file","video"];if(a.includes(s.type)){if(!s.preview)return this.$message.error("没有配置预览接口");this.previewUrl=s.preview,this.drawer=!0}},playVoice(e,t){this.playAudio=new Audio(e.content),this.playAudio.play(),t.updateMessage({id:e.id,status:"succeed",isPlay:1})},openChat(e,t){this.keywords="",t.changeContact(e)},handleChangeContact(e,t){t.updateContact({id:e.id,unread:0}),this.unread-=e.unread,this.pageSize=1,this.displayName=e.displayName,this.oldName=e.displayName,this.currentChat=e,1==e.is_group&&this.group_id!=e.id&&this.getGroupUserList(e.id),this.is_group=e.is_group,1==this.is_group&&(this.group_id=e.id,this.notice=e.notice);var s=[];const{IMUI:i}=this.$refs;for(var a=i.getMessages(e.id),n=0;a.length>n;n++)0==a[n].is_read&&a[n].fromUser.id!=this.user.id&&s.push(a[n]);s.length>0&&(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.$M)({is_group:e.is_group,toContactId:e.id,messages:s,fromUser:e.id}).then((e=>{0==e.code&&this.setLocalMsgIsRead(s)})),t.closeDrawer()},uploadVideo(e){let t,s=e.srcElement.files[0],i=URL.createObjectURL(s),a=new Audio(i);a.addEventListener("loadedmetadata",(function(e){t=a.duration}));let n={content:i,fromUser:this.user,id:(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.NW)(),sendTime:getTime(),status:"going",toContactId:this.currentChat.id,type:"video",extends:{duration:t}};this.diySendMessage(n,s),this.$refs.uploadVideo.value=""},sendVoice(e,t){let s={content:URL.createObjectURL(t),fromUser:this.user,id:(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.NW)(),sendTime:getTime(),status:"going",toContactId:this.currentChat.id,type:"voice",isPlay:0,extends:{duration:e}};this.VoiceStatus=!1,this.diySendMessage(s,t)},diySendMessage(e,t){const{IMUI:s}=this.$refs;s.appendMessage(e,!0),this.handleSend(e,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{status:"succeed"};s.updateContact({id:e.toContactId,lastContent:s.lastContentRender(e),lastSendTime:e.sendTime}),s.CacheDraft.remove(e.toContactId),s.updateMessage(Object.assign(e,t))}),t)},handleSend(e,t,s){let i=new FormData;e.is_group=this.is_group;const{IMUI:a}=this.$refs;if(s){if(s.size>5242880)return a.removeMessage(e.id),this.$message.error("上传的内容不等大于5MB！");i.append("file",s),i.append("message",JSON.stringify(e)),(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.W0)(i).then((e=>{a.updateMessage(e.data),t()})).catch((s=>{401==s.code?a.removeMessage(e.id):t({status:"failed"})}))}else(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.pi)(e).then((e=>{a.setEditorValue(""),a.updateMessage(e.data),t()})).catch((s=>{401==s.code?a.removeMessage(e.id):t({status:"failed"})}))},handlePullMessages(e,t,s){return(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.lX)({toContactId:e.id,is_group:e.is_group,pageSize:this.pageSize,listRows:this.listRows}).then((e=>{this.pageSize++;let s=!1,i=e.data;i.length<this.listRows&&(s=!0),t(i,s)})).catch((e=>{t([],!0)})),!0},publishNotice(){this.noticeBox=!1,(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.qj)({id:this.group_id,notice:this.notice}).then((e=>{0==e.code&&this.$message({type:"success",message:"发布成功!"})}))},openNotice(){var e="<div style='white-space: pre;'>"+this.notice+"</div>";this.$alert(e,"群公告",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0})},getAllUser(e){(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.xt)(e).then((e=>{const t=e.data;this.allUser=t}))},openCreateGroup(){this.getAllUser({}),this.createChatBox=!0},openAddGroupUser(){var e=(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.Nj)(this.groupUser,"user_id");this.getAllUser({user_ids:e}),this.addGroupUserBox=!0},fn(e){return new Promise(((t,s)=>{(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.pi)(e).then((e=>{0===e.code?t(e):this.$message.error(e.msg)})).catch((e=>{}))}))},async test(e){let t=await this.fn(e);return t},forwardUser(){var e=this.selectUid;if(this.selectUid=[],e.length>5)return this.$message.error("转发的人数不能超过5人！");this.forwardBox=!1;for(var t=this.currentMessage,s=[],i=0;i<e.length;i++){var a=e[i].toString();t.id=(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.NW)(),t.status="successd",t.sendTime=getTime(),t.toContactId=a,t.fromUser=this.user,t.is_group=0,-1!=a.indexOf("group")&&(t.is_group=1),s.push(this.test(t))}Promise.all(s).then((e=>{const{IMUI:t}=this.$refs;for(var s=0;s<e.length;s++){var i=e[s].data;0==i.is_group&&(i.toContactId=parseInt(i.toContactId)),t.appendMessage(i),t.updateContact({id:i.toContactId,unread:0})}})).catch((e=>{console.log("error",e)}))},addGroupUser(){this.addGroupUserBox=!1,(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.R7)({user_ids:this.selectUid,id:this.group_id}),this.selectUid=[]},createGroup(){this.createChatBox=!1,(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.NQ)({user_ids:this.selectUid}).then((e=>{const t=e.data,{IMUI:s}=this.$refs;0==e.code&&(s.appendContact(t),s.changeContact(t.id)),this.selectUid=[]}))},getGroupUserList(e){(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.O2)({group_id:e}).then((e=>{if(0==e.code){var t=e.data;this.groupUser=t,this.groupUserCount=t.length}}))},saveGroupName(e){if(this.displayName.length<1)return this.$notify({title:"警告",message:"名称不能为空！",type:"warning"}),this.isEdit=!1,!1;if(this.displayName!=this.oldName){const{IMUI:t}=this.$refs;(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.ey)({id:e.id,displayName:this.displayName}).then((s=>{t.updateContact({id:e.id,displayName:this.displayName})}))}this.isEdit=!1},closeSearch(){var e=this;setTimeout((function(){e.searchResult=!1}),300)},searchContact(e){""!=this.keywords&&(this.searchList=(0,_utils_index__WEBPACK_IMPORTED_MODULE_5__.iu)(e,["displayName","name_py"],this.keywords))},setLocalMsgIsRead(e){const{IMUI:t}=this.$refs;for(let s=0;e.length>s;s++){const i={id:e[s]["id"],is_read:1,status:"succeed",content:e[s]["content"]+" "};t.updateMessage(i)}},download(e,t,s){let i=document.createElement("a");i.download="image"==s?t||"pic":t||"file",i.href=e,i.click()},popNotice(e){let t=this;if("granted"==Notification.permission){let s=new Notification("收到一条新消息",{body:e.fromUser.displayName+"："+e.content,icon:e.fromUser.avatar});s.onclick=function(e){t.$nextTick((()=>{setTimeout((()=>{}),500)})),window.focus(),s.close()},console.log("浏览器通知！")}else{console.log("声音通知！");const e=document.getElementById("chatAudio");e.currentTime=0,e.play()}},recieveMsg(e){const{IMUI:t}=this.$refs,s=t.getCurrentContact();if(s.id==e.toContactId){var i=[];i.push(e),(0,_api_im__WEBPACK_IMPORTED_MODULE_3__.$M)({toContactId:s.id,is_group:s.is_group,messages:i,fromUser:e.fromUser.id})}else this.user.id!=e.fromUser.id&&this.unread++;this.user.id==e.toContactId&&(e.toContactId=e.toUser),t.appendMessage(e,!0)},openGallery(){this.$message({message:"即将呈现！",type:"warning"})},openMessageBox(){this.messageBox=!0,this.componentKey+=1},changeDrawer(e,t){const s=this.$createElement;t.changeDrawer({offsetX:0,offsetY:1,render:()=>s("div",{class:"drawer-content"},[s("p",[s("b",["自定义抽屉"])]),s("p",[e.displayName])])})},logout(){this.$confirm("你确定要退出聊天室吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$store.dispatch("LogOut").then((()=>{this.$router.push({path:"/login"})}))})).catch((()=>{this.$message({type:"info",message:"已取消退出"})}))}}}},1739:function(e,t,s){"use strict";s.d(t,{$M:function(){return c},BN:function(){return a},Cj:function(){return l},NQ:function(){return m},O2:function(){return _},R:function(){return g},R7:function(){return f},W0:function(){return r},Wy:function(){return b},eF:function(){return v},ey:function(){return u},fF:function(){return M},lX:function(){return o},nW:function(){return h},pi:function(){return n},py:function(){return d},q3:function(){return y},qj:function(){return w},rb:function(){return C},xt:function(){return p}});var i=s(4471);function a(e){return(0,i.Z)({url:"enterprise/im/getContacts",method:"post",data:e})}function n(e){return(0,i.Z)({url:"enterprise/im/sendMessage",method:"post",data:e})}function r(e){return(0,i.Z)({url:"enterprise/upload/uploadFile",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}function o(e){return(0,i.Z)({url:"enterprise/im/getMessageList",method:"post",data:e})}function c(e){return(0,i.Z)({url:"enterprise/im/setMsgIsRead",method:"post",data:e})}function l(e){return(0,i.Z)({url:"enterprise/im/undoMessage",method:"post",data:e})}function d(e){return(0,i.Z)({url:"enterprise/im/setting",method:"post",data:e})}function u(e){return(0,i.Z)({url:"enterprise/group/editGroupName",method:"post",data:e})}function _(e){return(0,i.Z)({url:"enterprise/group/groupuserlist",method:"post",data:e})}function p(e){return(0,i.Z)({url:"enterprise/group/getAllUser",method:"post",data:e})}function m(e){return(0,i.Z)({url:"enterprise/group/add",method:"post",data:e})}function h(e){return(0,i.Z)({url:"enterprise/group/setManager",method:"post",data:e})}function g(e){return(0,i.Z)({url:"enterprise/group/removeUser",method:"post",data:e})}function f(e){return(0,i.Z)({url:"enterprise/group/addGroupUser",method:"post",data:e})}function v(e){return(0,i.Z)({url:"enterprise/group/removeGroup",method:"post",data:e})}function w(e){return(0,i.Z)({url:"enterprise/group/setNotice",method:"post",data:e})}function C(e){return(0,i.Z)({url:"enterprise/group/groupSetting",method:"post",data:e})}function b(e){return(0,i.Z)({url:"enterprise/group/groupInfo",method:"post",data:e})}function y(e){return(0,i.Z)({url:"enterprise/im/isNotice",method:"post",data:e})}function M(e){return(0,i.Z)({url:"enterprise/im/setChatTop",method:"post",data:e})}},2223:function(e,t,s){"use strict";s.d(t,{Ig:function(){return o},UO:function(){return a},uc:function(){return r},y5:function(){return n},zQ:function(){return c}});var i=s(4471);function a(e){return(0,i.Z)({url:"common/pub/login",method:"post",data:e})}function n(){return(0,i.Z)({url:"common/pub/logout",method:"post"})}function r(e){return(0,i.Z)({url:"common/pub/bindUid",method:"post",data:e})}function o(e){return(0,i.Z)({url:"common/pub/offline",method:"post",data:e})}function c(e){return(0,i.Z)({url:"common/pub/bindGroup",method:"post",data:e})}},8692:function(e,t,s){"use strict";var i=s(3032),a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},n=[],r={name:"App"},o=r,c=s(1001),l=(0,c.Z)(o,a,n,!1,null,null,null),d=l.exports,u=s(8499),_=s.n(u),p=s(7002),m=s.n(p),h=s(3587),g=s(4239),f=s(5602),v=s.n(f),w=s(530),C=s.n(w),b=(s(6265),s(9886));const y=["/login","/welcome"];h.ZP.beforeEach(((e,t,s)=>{e.meta.disabled?s(!1):(C().start(),(0,b.v0)()?y.includes(e.path)?(s({path:"/"}),C().done()):s():-1!==y.indexOf(e.path)?s():(s("/login"),C().done()))})),h.ZP.afterEach((()=>{C().done()})),h.ZP.onError((e=>{const t=/Loading chunk (\d)+ failed/g,s=e.message.match(t),i=h.ZP.history.pending.fullPath;s&&h.ZP.replace(i)}));var M,x,k,D,E=s(8701),O=s.n(E),U={name:"lemonMessageVoice",inheritAttrs:!1,inject:["IMUI"],render(){const e=arguments[0];return e("lemon-message-basic",O()([{class:"lemon-message-voice"},{props:{...this.$attrs}},{attrs:{reverse:this.$attrs.reverse,message:this.$attrs.message,hideName:this.$attrs.hideName,hideTime:this.$attrs.hideTime},scopedSlots:{content:t=>e("div",{class:["voice-card lz-flex lz-justify-content-start lz-align-items-center",{"im-rows-reverse":this.$attrs.reverse}],style:{width:3*t.extends.duration+"px"}},[e("div",{class:["iconfont icon-im-yuyin f-16",{"voice-icon":t.isPlay},{rotate180:this.$attrs.reverse}]}),"  ",e("div",[t.extends.duration,'"'])])}}]))}},I=U,T=(0,c.Z)(I,M,x,!1,null,null,null),P=T.exports,K={name:"lemonMessageVideo",inheritAttrs:!1,inject:["IMUI"],render(){const e=arguments[0];return e("lemon-message-basic",O()([{class:"lemon-message-video"},{props:{...this.$attrs}},{attrs:{reverse:this.$attrs.reverse,message:this.$attrs.message,hideName:this.$attrs.hideName,hideTime:this.$attrs.hideTime},scopedSlots:{content:t=>e("div",{class:["video-card"],style:{}},[e("el-image",{style:"max-height: 200px",attrs:{src:t.extends.poster,fit:"cover"}},[e("div",{slot:"error",class:"image-slot"},[e("i",{class:"el-icon-picture-outline"})])]),t.extends.duration,e("div",{class:"video-shadow"},[e("div",{class:"el-icon el-icon-video-play c-white f-28 video-icon"})])])}}]))}},S=K,B=(0,c.Z)(S,k,D,!1,null,null,null),L=B.exports;i["default"].use(_(),{size:"small"}),i["default"].use(m()),i["default"].use(g.Z),i["default"].use(v()),i["default"].config.productionTip=!1,i["default"].component(L.name,L),i["default"].component(P.name,P),new i["default"]({el:"#app",router:h.ZP,store:g.Z,components:{App:d},template:"<App/>"})},3587:function(e,t,s){"use strict";s.d(t,{ZP:function(){return A},PV:function(){return L}});var i=s(3032),a=s(2631),n=(s(7658),function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-container"},[t("div",{staticClass:"im-title"},[t("div",{staticClass:"logo"},[t("el-image",{staticStyle:{width:"80px",height:"80px"},attrs:{src:e.packageData.logo,fit:"cover"}})],1),t("div",{staticClass:"im-content"},[t("div",{staticClass:"im-name"},[t("div",{staticClass:"text f-36"},[e._v(e._s(e.packageData.name))]),t("div",{staticClass:"version ml-5"},[t("el-tag",{attrs:{size:"mini",type:"primary",effect:"plain"}},[e._v("v"+e._s(e.packageData.version))])],1)]),t("div",{staticClass:"im-des"},[e._v(e._s(e.packageData.description))])])]),t("div",{staticClass:"code-url mb-20"},[t("div",{staticClass:"ml-15"},[e._v(" 前端地址："),t("a",{attrs:{href:e.packageData.frontUrl,target:"_blank"}},[t("el-image",{attrs:{src:e.packageData.frontUrl+"/badge/star.svg?theme=white",alt:"star"}})],1)]),t("div",{staticClass:"ml-15"},[e._v(" 后端地址："),t("a",{attrs:{href:e.packageData.backstageUrl,target:"_blank"}},[t("el-image",{attrs:{src:e.packageData.backstageUrl+"/badge/star.svg?theme=dark",alt:"star"}})],1)]),t("div",{staticClass:"ml-15"},[t("el-button",{attrs:{type:"warning",plain:"",size:"mini",round:""}},[t("a",{attrs:{href:e.packageData.qqGroupUrl,target:"_blank"}},[e._v("QQ交流群:336921267")])])],1),t("div",{staticClass:"ml-15"},[t("el-button",{attrs:{plain:"",size:"mini",round:""}},[t("a",{attrs:{href:"http://june000.gitee.io/lemon-im",target:"_blank"}},[e._v("Lemon-IMUI手册")])])],1)]),t("div",{staticClass:"tip"},[t("p",[e._v(" 1. "+e._s(e.packageData.name)+"是一个开源的即时通信demo，主要用于学习交流，为大家提供即时通讯的开发思路，许多功能需要自行开发，开发的初衷旨在快速建立企业内部通讯系统，不建议用于商业用途。 ")]),t("p",[e._v(" 2. 目前仅开源了网页端(lemon-imui+element-ui)和后台接口（TP6+workerman），主要是对接企业应用等内部聊天，非社区版，没有后台管理。移动端代码仅实现了基础聊天功能，无群聊管理等相关功能，未开源。 ")])]),t("div",{staticClass:"demo-btn"},[t("div",{staticClass:"flex-box-center",on:{click:function(t){return e.showMessageBox()}}},[t("el-badge",{staticClass:"item",attrs:{value:e.unread,max:99,hidden:!e.unread}},[t("el-button",[e._v("打开消息盒子")])],1)],1),t("div",{on:{click:function(t){return e.$router.push({path:"/chat"})}}},[t("el-button",[e._v("原来的DEMO")])],1),t("div",{staticClass:"ml-20"},[t("el-button",[t("a",{attrs:{href:e.packageData.mobileUrl,target:"_blank"}},[e._v("移动端体验")])])],1)]),t("div",{staticClass:"contact-main"},[t("div",{staticClass:"title"},[e._v("联系人")]),e._l(e.allContacts,(function(s){return 0==s.is_group?t("div",{key:s.id,staticClass:"contact-box"},[t("div",{staticClass:"contact-item"},[t("el-avatar",{attrs:{src:s.avatar}}),t("span",[e._v(e._s(s.realname))]),t("div",[t("el-button",{attrs:{plain:"",size:"mini",round:""},on:{click:function(t){return e.$store.commit("openChat",s.id)}}},[e._v("发消息")])],1)],1)]):e._e()}))],2),e._m(0),t("p",[t("el-image",{staticStyle:{width:"300px"},attrs:{src:"https://emoji.raingad.com/file/wx.jpg"}}),t("el-image",{staticClass:"ml-40",staticStyle:{width:"300px"},attrs:{src:"https://emoji.raingad.com/file/zfb.jpg"}})],1),e._m(1),t("Message",{ref:"Message",attrs:{dialogTableVisible:e.dialogTableVisible},on:{"update:dialogTableVisible":function(t){e.dialogTableVisible=t},"update:dialog-table-visible":function(t){e.dialogTableVisible=t}}})],1)}),r=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"warning"},[t("p",[e._v(" 详细的使用方法在源码中基本上都有备注，如果您觉得这个项目对您有帮助，欢迎star，如果有问题可以加QQ群交流，如果您有更好的建议，欢迎提出。如果觉得项目不错，不如请作者喝杯奶茶吧~ ")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"tip"},[t("p",[e._v("开源不易，同时如果需要以下功能，作者提供付费服务，收费标准为：进群后咨询作者！")]),t("p",[e._v("1. 协助部署：200元/次（需要自行安装好运行环境，最好是宝塔面板）")]),t("p",[e._v("2. 1v1音视频通话源码：200元/套")]),t("p",[e._v("3. uniapp移动端源码：200元/套")])])}],o=s(4147),c=s(3822),l=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.dialogTableVisible,expression:"dialogTableVisible"}],staticClass:"messageBoxStyle"},[t("el-dialog",{attrs:{visible:e.dialogIsShow,modal:!1,"custom-class":"sideMenu-message","show-close":!1,width:"1000px","close-on-press-escape":!0},on:{"update:visible":function(t){e.dialogIsShow=t},close:e.closeDialog}},[t("div",{staticClass:"chat-box"},[t("lemon-imui",{ref:"IMUI",staticStyle:{"min-height":"600px"},attrs:{user:e.user,width:"1000px",height:e.height,contextmenu:e.contextmenu,"contact-contextmenu":e.contactContextmenu,theme:e.setting.theme,"hide-message-name":e.setting.hideMessageName,"hide-message-time":e.setting.hideMessageTime,avatarCricle:e.setting.avatarCricle,sendKey:e.setSendKey,wrapKey:e.wrapKey},on:{"change-contact":e.handleChangeContact,"pull-messages":e.handlePullMessages,"message-click":e.handleMessageClick,send:e.handleSend},scopedSlots:e._u([{key:"cover",fn:function(){return[t("div",[t("div",{staticClass:"cover"},[t("i",{staticClass:"lemon-icon-message"}),t("p",[t("b",[e._v("即时聊天 Raingad")]),e._v(" IM")])])])]},proxy:!0},{key:"sidebar-message",fn:function(s){return[t("span",{staticClass:"lemon-badge lemon-contact__avatar"},[t("span",{staticClass:"lemon-avatar",class:{"lemon-avatar--circle":e.setting.avatarCricle},staticStyle:{width:"40px",height:"40px","line-height":"40px","font-size":"20px"}},[t("img",{attrs:{src:s.avatar}})]),s.unread>0&&1==s.is_notice?t("span",{staticClass:"lemon-badge__label"},[e._v(e._s(s.unread))]):e._e()]),t("div",{staticClass:"lemon-contact__inner"},[t("p",{staticClass:"lemon-contact__label"},[t("span",{staticClass:"lemon-contact__name"},[s.is_online&&0==s.is_group?t("span",{staticClass:"online-status",attrs:{title:"在线"}}):e._e(),1==s.is_group?t("el-tag",{attrs:{size:"mini"}},[e._v("群聊")]):e._e(),e._v(" "+e._s(s.displayName)+" ")],1),t("span",{staticClass:"lemon-contact__time",domProps:{textContent:e._s(e.formatTime(s.lastSendTime))}})]),t("p",{staticClass:"lemon-contact__content lemon-last-content"},[t("span",{staticClass:"lastContent"},[0==s.is_notice&&s.unread>0?t("span",[e._v("["+e._s(s.unread)+"条未读]")]):e._e(),t("span",{domProps:{innerHTML:e._s(s.lastContent)}})]),0==s.is_notice?t("span",{staticClass:"el-icon-close-notification font-16"}):e._e()])])]}},{key:"message-title",fn:function(s){return[t("div",{staticClass:"message-title-box"},[t("div",[0==e.isEdit?t("span",[1==e.is_group?t("span",{staticClass:"displayName",on:{click:function(t){e.isEdit=!0}}},[t("el-tag",{attrs:{size:"mini"}},[e._v("群聊")]),e._v(" "+e._s(s.displayName)),t("span",[e._v("("+e._s(e.groupUserCount)+")")]),1==s.setting.nospeak?t("el-tag",{attrs:{size:"mini",type:"warning"}},[e._v("仅群管理员可发言")]):e._e(),2==s.setting.nospeak?t("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v("全员禁言中")]):e._e()],1):e._e(),0==e.is_group?t("span",{staticClass:"displayName"},[s.is_online?t("el-tag",{attrs:{size:"mini",type:"success"}},[e._v("在线")]):e._e(),s.is_online?e._e():t("el-tag",{attrs:{size:"mini",type:"info"}},[e._v("离线 ")]),e._v(" "+e._s(s.displayName))],1):e._e()]):e._e(),1==e.isEdit?t("input",{directives:[{name:"model",rawName:"v-model",value:e.displayName,expression:"displayName"}],staticClass:"editInput",domProps:{value:e.displayName},on:{blur:function(t){return e.saveGroupName(s)},input:function(t){t.target.composing||(e.displayName=t.target.value)}}}):e._e()]),t("div",{staticClass:"message-title-tools"},[s.is_group?e._e():t("i",{staticClass:"el-icon-phone-outline mr-10",attrs:{title:"语音通话"},on:{click:function(t){return e.called(!1)}}}),s.is_group?e._e():t("i",{staticClass:"el-icon-video-camera mr-10",attrs:{title:"视频通话"},on:{click:function(t){return e.called(!0)}}}),t("i",{staticClass:"el-icon-time",attrs:{title:"消息管理器"},on:{click:e.openMessageBox}})])])]}},{key:"sidebar-message-fixedtop",fn:function(s){return[t("div",{staticClass:"contact-fixedtop-box"},[t("el-input",{staticClass:"input-with-select",attrs:{placeholder:"搜索联系人","prefix-icon":"el-icon-search"},on:{blur:e.closeSearch,focus:function(t){e.searchResult=!0}},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),t("div",{staticStyle:{"margin-left":"10px"}},[t("el-button",{attrs:{title:"创建群聊",icon:"el-icon-plus",circle:""},on:{click:e.openCreateGroup}})],1),e.searchResult?t("div",{staticClass:"search-list"},[e._l(e.searchList,(function(i,a){return e.searchList.length>0?t("div",{key:a,staticClass:"search-list-item"},[t("lemon-contact",{attrs:{contact:i},on:{click:function(t){return e.openChat(i.id,s)}}})],1):e._e()})),0==e.searchList.length?t("div",{staticStyle:{margin:"20px"},attrs:{align:"center"}},[e._v(" 暂无 ")]):e._e()],2):e._e()],1)]}},{key:"sidebar-message-top",fn:function(s){return[e.chatTopList.length>0?t("div",{staticClass:"chat-top-list"},e._l(e.chatTopList,(function(i,a){return t("ChatTop",{key:a,attrs:{contact:i,avatarCricle:e.setting.avatarCricle,currentId:e.currentChat.id},nativeOn:{click:function(t){return e.openChat(i.id,s)}}})})),1):e._e()]}},{key:"sidebar-contact-fixedtop",fn:function(s){return[t("div",{staticStyle:{margin:"15px 10px"}},[e._v(" 联系人 ")])]}},{key:"message-side",fn:function(s){return[1==s.is_group?t("div",{staticClass:"slot-group-list"},[t("div",{staticClass:"group-side-box"},[t("div",{staticClass:"group-notice"},[t("div",{staticClass:"group-side-title"},[t("h4",[e._v("群公告")]),t("div",[s.role<3||0==s.setting.manage?t("span",{staticClass:"el-icon-edit font-18 handle",on:{click:function(t){e.noticeBox=!0}}}):e._e()])]),t("hr"),s.notice?t("div",{staticClass:"group-side-body",on:{click:e.openNotice}},[e._v(" "+e._s(s.notice)+" ")]):e._e(),s.notice?e._e():t("div",{staticClass:"group-side-body"},[e._v(" 暂无公告 ")])]),t("div",{staticClass:"group-user"},[t("div",{staticClass:"group-side-title"},[t("h4",[e._v("群成员")]),t("div",[s.role<3||1==s.setting.invite?t("span",{staticClass:"el-icon-circle-plus-outline font-18 handle",on:{click:e.openAddGroupUser}}):e._e()])]),t("hr"),t("div",{staticClass:"group-user-body",attrs:{id:"group-user"}},[t("el-scrollbar",{staticStyle:{height:"100%"}},e._l(e.groupUser,(function(s,i){return t("lemon-contact",{directives:[{name:"lemon-contextmenu",rawName:"v-lemon-contextmenu.contact",value:e.groupMenu,expression:"groupMenu",modifiers:{contact:!0}}],key:i,staticClass:"user-list",attrs:{contact:s}},[t("div",{staticClass:"user-avatar"},[t("el-avatar",{attrs:{size:20,src:s.userInfo.avatar}})],1),t("div",{staticClass:"user-name"},[s.userInfo.id==e.user.id?t("span",{staticClass:"fc-danger"},[e._v(e._s(s.userInfo.displayName)+"（我）")]):e._e(),s.userInfo.id!=e.user.id?t("span",[e._v(e._s(s.userInfo.displayName))]):e._e()]),t("div",{staticClass:"user-role"},[1==s.role?t("i",{staticClass:"el-icon-user-solid fc-danger",attrs:{title:"创建者"}}):e._e(),2==s.role?t("i",{staticClass:"el-icon-user-solid fc-warning",attrs:{title:"管理员"}}):e._e()])])})),1)],1)])])]):e._e()]}},{key:"message-after",fn:function(s){return[s.fromUser.id==e.user.id&&0==s.is_group?t("span",{staticStyle:{visibility:"visible"}},[s.is_read?e._e():t("span",[e._v(" 未读 ")]),s.is_read?t("span",{staticStyle:{color:"green"}},[e._v(" 已读 ")]):e._e()]):e._e()]}},{key:"editor-footer",fn:function(){return[e._v(" "+e._s(e.sendTips)+" ")]},proxy:!0}])})],1),t("el-dialog",{attrs:{title:"创建群聊",visible:e.createChatBox,modal:!0,width:"612px"},on:{"update:visible":function(t){e.createChatBox=t}}},[t("el-transfer",{attrs:{filterable:"",titles:e.createChatTitles,"filter-placeholder":"请输入关键词",props:e.defaultProps,data:e.allUser},model:{value:e.selectUid,callback:function(t){e.selectUid=t},expression:"selectUid"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.createChatBox=!1,e.selectUid=[]}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.createGroup}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"添加成员",visible:e.addGroupUserBox,modal:!0,width:"612px"},on:{"update:visible":function(t){e.addGroupUserBox=t}}},[t("el-transfer",{attrs:{filterable:"",titles:e.createChatTitles,"filter-placeholder":"请输入关键词",props:e.defaultProps,data:e.allUser},model:{value:e.selectUid,callback:function(t){e.selectUid=t},expression:"selectUid"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addGroupUserBox=!1,e.selectUid=[]}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addGroupUser}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"设置",visible:e.settingBox,modal:!0,width:"550px"},on:{"update:visible":function(t){e.settingBox=t}}},[t("el-tabs",{staticStyle:{"min-height":"300px"},attrs:{"tab-position":e.tabPosition}},[t("el-tab-pane",{attrs:{label:"账号设置"}},[t("div",{attrs:{align:"center"}},[t("el-avatar",{attrs:{src:e.user.avatar,size:50}}),t("br"),t("br"),t("p",[e._v(e._s(e.user.displayName))]),t("br"),t("p",[e._v("账号："+e._s(e.user.account))]),t("br"),t("el-button",{attrs:{type:"danger"},on:{click:e.logout}},[e._v("退出登录")])],1)]),t("el-tab-pane",{attrs:{label:"通用设置"}},[t("el-form",{ref:"form",attrs:{model:e.setting,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"发送消息："}},[t("el-radio-group",{model:{value:e.setting.sendKey,callback:function(t){e.$set(e.setting,"sendKey",t)},expression:"setting.sendKey"}},[t("el-radio-button",{attrs:{label:"1"}},[e._v("Enter")]),t("el-radio-button",{attrs:{label:"2"}},[e._v("Ctrl + Enter")])],1)],1),t("el-form-item",{attrs:{label:"系统主题："}},[t("el-radio-group",{model:{value:e.setting.theme,callback:function(t){e.$set(e.setting,"theme",t)},expression:"setting.theme"}},[t("el-radio-button",{attrs:{label:"default"}}),t("el-radio-button",{attrs:{label:"blue"}})],1)],1)],1),t("div",{staticClass:"setting-switch"},[t("el-switch",{model:{value:e.setting.isVoice,callback:function(t){e.$set(e.setting,"isVoice",t)},expression:"setting.isVoice"}}),e._v(" 开启新消息声音提醒 ")],1),t("div",{staticClass:"setting-switch"},[t("el-switch",{model:{value:e.setting.avatarCricle,callback:function(t){e.$set(e.setting,"avatarCricle",t)},expression:"setting.avatarCricle"}}),e._v(" 开启聊天圆形头像（需要刷新） ")],1),t("div",{staticClass:"setting-switch"},[t("el-switch",{model:{value:e.setting.hideMessageName,callback:function(t){e.$set(e.setting,"hideMessageName",t)},expression:"setting.hideMessageName"}}),e._v(" 是否隐藏聊天窗口内的联系人名字 ")],1),t("div",{staticClass:"setting-switch"},[t("el-switch",{model:{value:e.setting.hideMessageTime,callback:function(t){e.$set(e.setting,"hideMessageTime",t)},expression:"setting.hideMessageTime"}}),e._v(" 是否隐藏聊天窗口内的消息发送时间 ")],1)],1),t("el-tab-pane",{attrs:{label:"关于 IM"}},[t("div",{attrs:{align:"center"}},[t("el-avatar",{attrs:{src:e.packageData.logo,size:50}}),t("br"),t("br"),t("p",[t("span",{staticClass:"main-color"},[e._v(" "+e._s(e.packageData.name)+" ")]),e._v("for "+e._s(e.packageData.version)+" ")])],1),t("div",{staticClass:"setting-version"},[t("b",[e._v(" 已经支持功能：")]),t("p",[e._v("1、单聊和群聊，新增消息管理器")]),t("p",[e._v("2、支持发送表情、图片、语音、视频和文件消息")]),t("p",[e._v("3、单聊支持消息已读未读的状态显示")]),t("p",[e._v("4、支持设置新消息声音提醒，浏览器通知")]),t("p",[e._v("5、支持部分Lemon-imui内功能设置")]),t("p",[e._v("6、支持文件、图片和绝大部分媒体文件在线预览")]),t("p",[e._v("7、群聊创建、删除和群成员管理、群公告、群禁言等")]),t("p",[e._v("8、可以置顶联系人，所有联系人可以设置消息免打扰")]),t("p",[e._v("9、全新支持增加音视频通话(一对一)")])])]),t("el-tab-pane",{attrs:{label:"开源"}},[t("div",{attrs:{align:"center"}},[t("el-avatar",{attrs:{src:e.packageData.logo,size:50}}),t("br"),t("br"),t("p",[t("span",{staticClass:"main-color"},[e._v(" "+e._s(e.packageData.name)+" ")]),e._v("for "+e._s(e.packageData.version)+" ")])],1),t("div",{staticClass:"setting-version"},[t("p",[e._v(" 前端地址："),t("a",{staticClass:"main-color",attrs:{href:e.packageData.frontUrl,target:"_blank"}},[e._v("[链接] im-chat-front")])]),t("p",[e._v(" 后端地址："),t("a",{staticClass:"main-color",attrs:{href:e.packageData.backstageUrl,target:"_blank"}},[e._v("[链接] im-instant-chat")])])]),t("div",{staticClass:"setting-version",staticStyle:{color:"#a6a6a6"}},[t("p",[e._v("前端技术栈：vue+Lemon-IMUI+element-UI")]),t("p",[e._v("后端技术栈：thinkphp6+workerman")])]),t("div",{staticClass:"setting-version"},[t("p",[e._v(" QQ交流群： "),t("a",{staticClass:"main-color",attrs:{href:e.packageData.qqGroupUrl,target:"_blank"}},[e._v("336921267")])])])])],1)],1),t("el-dialog",{attrs:{title:"发布公告",visible:e.noticeBox,modal:!0,width:"500px"},on:{"update:visible":function(t){e.noticeBox=t}}},[t("el-input",{attrs:{type:"textarea",rows:10,placeholder:"请输入内容"},model:{value:e.notice,callback:function(t){e.notice=t},expression:"notice"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.noticeBox=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.publishNotice}},[e._v("确 定")])],1)],1),t("transition",{attrs:{name:"fade-user"}},[e.drawer?t("div",{staticClass:"previewBox"},[t("el-button",{staticClass:"drawer-close",attrs:{type:"danger",icon:"el-icon-close",circle:""},on:{click:function(t){e.drawer=!e.drawer}}}),t("iframe",{attrs:{src:e.previewUrl,frameborder:"0",width:"100%",height:"100%"}})],1):e._e()]),t("el-dialog",{attrs:{title:"转发",visible:e.forwardBox,modal:!0,width:"612px"},on:{"update:visible":function(t){e.forwardBox=t}}},[t("el-transfer",{attrs:{filterable:"",titles:e.createChatTitles,"filter-placeholder":"请输入关键词",props:e.contactsProps,data:e.allUser},model:{value:e.selectUid,callback:function(t){e.selectUid=t},expression:"selectUid"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.forwardBox=!1,e.selectUid=[]}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.forwardUser}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"消息管理器",visible:e.messageBox,modal:!0,width:"800px"},on:{"update:visible":function(t){e.messageBox=t}}},[t("ChatRecord",{key:e.componentKey,attrs:{contact:e.currentChat}})],1),t("el-dialog",{attrs:{title:"群设置",visible:e.groupSetting,modal:!0,width:"500px"},on:{"update:visible":function(t){e.groupSetting=t}}},[t("ChatSet",{key:e.componentKey,attrs:{contact:e.contactSetting}})],1),t("el-dialog",{attrs:{title:"语音录制","custom-class":"no-padding",visible:e.VoiceStatus,modal:!0,width:"500px","append-to-body":"","destroy-on-close":""},on:{"update:visible":function(t){e.VoiceStatus=t}}},[t("voice-recorder",{on:{send:e.sendVoice}})],1),t("Socket",{ref:"socket"}),t("webrtc",{key:e.componentKey,ref:"webrtc",attrs:{contact:e.currentChat,config:e.webrtcConfig,alias:e.packageData.name,userInfo:e.user}})],1)],1)},d=[],u=s(2936),_=u.Z,p=s(1001),m=(0,p.Z)(_,l,d,!1,null,"5f058b6e",null),h=m.exports,g={name:"Index",components:{Message:h},data(){return{packageData:o,dialogTableVisible:!1,unread:0,allContacts:[]}},computed:{...(0,c.rn)({chatSocket:e=>e.unread,getContacts:e=>e.allContacts})},watch:{chatSocket(e){this.unread=e},getContacts(e){this.allContacts=e}},methods:{showMessageBox(){this.dialogTableVisible?this.dialogTableVisible=!1:this.dialogTableVisible=!0}}},f=g,v=(0,p.Z)(f,n,r,!1,null,"592a1b49",null),w=v.exports,C=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-container",style:"background-image:url("+e.Background+")"},[t("div",{staticClass:"chat-box"},[t("lemon-imui",{ref:"IMUI",staticStyle:{"min-height":"600px"},attrs:{user:e.user,width:"1000px",height:e.height,contextmenu:e.contextmenu,"contact-contextmenu":e.contactContextmenu,theme:e.setting.theme,"hide-message-name":e.setting.hideMessageName,"hide-message-time":e.setting.hideMessageTime,avatarCricle:e.setting.avatarCricle,sendKey:e.setSendKey,wrapKey:e.wrapKey},on:{"change-contact":e.handleChangeContact,"pull-messages":e.handlePullMessages,"message-click":e.handleMessageClick,send:e.handleSend},scopedSlots:e._u([{key:"cover",fn:function(){return[t("div",[t("div",{staticClass:"cover"},[t("i",{staticClass:"lemon-icon-message"}),t("p",[t("b",[e._v("即时聊天 Raingad")]),e._v(" IM")])])])]},proxy:!0},{key:"sidebar-message",fn:function(s){return[t("span",{staticClass:"lemon-badge lemon-contact__avatar"},[t("span",{staticClass:"lemon-avatar",class:{"lemon-avatar--circle":e.setting.avatarCricle},staticStyle:{width:"40px",height:"40px","line-height":"40px","font-size":"20px"}},[t("img",{attrs:{src:s.avatar}})]),s.unread>0&&1==s.is_notice?t("span",{staticClass:"lemon-badge__label"},[e._v(e._s(s.unread))]):e._e()]),t("div",{staticClass:"lemon-contact__inner"},[t("p",{staticClass:"lemon-contact__label"},[t("span",{staticClass:"lemon-contact__name"},[s.is_online&&0==s.is_group?t("span",{staticClass:"online-status",attrs:{title:"在线"}}):e._e(),1==s.is_group?t("el-tag",{attrs:{size:"mini"}},[e._v("群聊")]):e._e(),e._v(" "+e._s(s.displayName)+" ")],1),t("span",{staticClass:"lemon-contact__time",domProps:{textContent:e._s(e.formatTime(s.lastSendTime))}})]),t("p",{staticClass:"lemon-contact__content lemon-last-content"},[t("span",{staticClass:"lastContent"},[0==s.is_notice&&s.unread>0?t("span",[e._v("["+e._s(s.unread)+"条未读]")]):e._e(),t("span",{domProps:{innerHTML:e._s(s.lastContent)}})]),0==s.is_notice?t("span",{staticClass:"el-icon-close-notification font-16"}):e._e()])])]}},{key:"message-title",fn:function(s){return[t("div",{staticClass:"message-title-box"},[t("div",[0==e.isEdit?t("span",[1==e.is_group?t("span",{staticClass:"displayName",on:{click:function(t){e.isEdit=!0}}},[t("el-tag",{attrs:{size:"mini"}},[e._v("群聊")]),e._v(" "+e._s(s.displayName)),t("span",[e._v("("+e._s(e.groupUserCount)+")")]),1==s.setting.nospeak?t("el-tag",{attrs:{size:"mini",type:"warning"}},[e._v("仅群管理员可发言")]):e._e(),2==s.setting.nospeak?t("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v("全员禁言中")]):e._e()],1):e._e(),0==e.is_group?t("span",{staticClass:"displayName"},[s.is_online?t("el-tag",{attrs:{size:"mini",type:"success"}},[e._v("在线")]):e._e(),s.is_online?e._e():t("el-tag",{attrs:{size:"mini",type:"info"}},[e._v("离线 ")]),e._v(" "+e._s(s.displayName))],1):e._e()]):e._e(),1==e.isEdit?t("input",{directives:[{name:"model",rawName:"v-model",value:e.displayName,expression:"displayName"}],staticClass:"editInput",domProps:{value:e.displayName},on:{blur:function(t){return e.saveGroupName(s)},input:function(t){t.target.composing||(e.displayName=t.target.value)}}}):e._e()]),t("div",{staticClass:"message-title-tools"},[s.is_group?e._e():t("i",{staticClass:"el-icon-phone-outline mr-10",attrs:{title:"语音通话"},on:{click:function(t){return e.called(!1)}}}),s.is_group?e._e():t("i",{staticClass:"el-icon-video-camera mr-10",attrs:{title:"视频通话"},on:{click:function(t){return e.called(!0)}}}),t("i",{staticClass:"el-icon-time",attrs:{title:"消息管理器"},on:{click:e.openMessageBox}})])])]}},{key:"sidebar-message-fixedtop",fn:function(s){return[t("div",{staticClass:"contact-fixedtop-box"},[t("el-input",{staticClass:"input-with-select",attrs:{placeholder:"搜索联系人","prefix-icon":"el-icon-search"},on:{blur:e.closeSearch,focus:function(t){e.searchResult=!0}},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),t("div",{staticStyle:{"margin-left":"10px"}},[t("el-button",{attrs:{title:"创建群聊",icon:"el-icon-plus",circle:""},on:{click:e.openCreateGroup}})],1),e.searchResult?t("div",{staticClass:"search-list"},[e._l(e.searchList,(function(i,a){return e.searchList.length>0?t("div",{key:a,staticClass:"search-list-item"},[t("lemon-contact",{attrs:{contact:i},on:{click:function(t){return e.openChat(i.id,s)}}})],1):e._e()})),0==e.searchList.length?t("div",{staticStyle:{margin:"20px"},attrs:{align:"center"}},[e._v(" 暂无 ")]):e._e()],2):e._e()],1)]}},{key:"sidebar-message-top",fn:function(s){return[e.chatTopList.length>0?t("div",{staticClass:"chat-top-list"},e._l(e.chatTopList,(function(i,a){return t("ChatTop",{key:a,attrs:{contact:i,avatarCricle:e.setting.avatarCricle,currentId:e.currentChat.id},nativeOn:{click:function(t){return e.openChat(i.id,s)}}})})),1):e._e()]}},{key:"sidebar-contact-fixedtop",fn:function(s){return[t("div",{staticStyle:{margin:"15px 10px"}},[e._v(" 联系人 ")])]}},{key:"message-side",fn:function(s){return[1==s.is_group?t("div",{staticClass:"slot-group-list"},[t("div",{staticClass:"group-side-box"},[t("div",{staticClass:"group-notice"},[t("div",{staticClass:"group-side-title"},[t("h4",[e._v("群公告")]),t("div",[s.role<3||0==s.setting.manage?t("span",{staticClass:"el-icon-edit font-18 handle",on:{click:function(t){e.noticeBox=!0}}}):e._e()])]),t("hr"),s.notice?t("div",{staticClass:"group-side-body",on:{click:e.openNotice}},[e._v(" "+e._s(s.notice)+" ")]):e._e(),s.notice?e._e():t("div",{staticClass:"group-side-body"},[e._v(" 暂无公告 ")])]),t("div",{staticClass:"group-user"},[t("div",{staticClass:"group-side-title"},[t("h4",[e._v("群成员")]),t("div",[s.role<3||1==s.setting.invite?t("span",{staticClass:"el-icon-circle-plus-outline font-18 handle",on:{click:e.openAddGroupUser}}):e._e()])]),t("hr"),t("div",{staticClass:"group-user-body",attrs:{id:"group-user"}},[t("el-scrollbar",{staticStyle:{height:"100%"}},e._l(e.groupUser,(function(s,i){return t("lemon-contact",{directives:[{name:"lemon-contextmenu",rawName:"v-lemon-contextmenu.contact",value:e.groupMenu,expression:"groupMenu",modifiers:{contact:!0}}],key:i,staticClass:"user-list",attrs:{contact:s}},[t("div",{staticClass:"user-avatar"},[t("el-avatar",{attrs:{size:20,src:s.userInfo.avatar}})],1),t("div",{staticClass:"user-name"},[s.userInfo.id==e.user.id?t("span",{staticClass:"fc-danger"},[e._v(e._s(s.userInfo.displayName)+"（我）")]):e._e(),s.userInfo.id!=e.user.id?t("span",[e._v(e._s(s.userInfo.displayName))]):e._e()]),t("div",{staticClass:"user-role"},[1==s.role?t("i",{staticClass:"el-icon-user-solid fc-danger",attrs:{title:"创建者"}}):e._e(),2==s.role?t("i",{staticClass:"el-icon-user-solid fc-warning",attrs:{title:"管理员"}}):e._e()])])})),1)],1)])])]):e._e()]}},{key:"message-after",fn:function(s){return[s.fromUser.id==e.user.id&&0==s.is_group?t("span",{staticStyle:{visibility:"visible"}},[s.is_read?e._e():t("span",[e._v(" 未读 ")]),s.is_read?t("span",{staticStyle:{color:"green"}},[e._v(" 已读 ")]):e._e()]):e._e()]}},{key:"editor-footer",fn:function(){return[e._v(" "+e._s(e.sendTips)+" ")]},proxy:!0}])})],1),t("el-dialog",{attrs:{title:"创建群聊",visible:e.createChatBox,modal:!0,width:"612px"},on:{"update:visible":function(t){e.createChatBox=t}}},[t("el-transfer",{attrs:{filterable:"",titles:e.createChatTitles,"filter-placeholder":"请输入关键词",props:e.defaultProps,data:e.allUser},model:{value:e.selectUid,callback:function(t){e.selectUid=t},expression:"selectUid"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.createChatBox=!1,e.selectUid=[]}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.createGroup}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"添加成员",visible:e.addGroupUserBox,modal:!0,width:"612px"},on:{"update:visible":function(t){e.addGroupUserBox=t}}},[t("el-transfer",{attrs:{filterable:"",titles:e.createChatTitles,"filter-placeholder":"请输入关键词",props:e.defaultProps,data:e.allUser},model:{value:e.selectUid,callback:function(t){e.selectUid=t},expression:"selectUid"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addGroupUserBox=!1,e.selectUid=[]}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addGroupUser}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"设置",visible:e.settingBox,modal:!0,width:"550px"},on:{"update:visible":function(t){e.settingBox=t}}},[t("el-tabs",{staticStyle:{"min-height":"300px"},attrs:{"tab-position":e.tabPosition}},[t("el-tab-pane",{attrs:{label:"账号设置"}},[t("div",{attrs:{align:"center"}},[t("el-avatar",{attrs:{src:e.user.avatar,size:50}}),t("br"),t("br"),t("p",[e._v(e._s(e.user.displayName))]),t("br"),t("p",[e._v("账号："+e._s(e.user.account))]),t("br"),t("el-button",{attrs:{type:"danger"},on:{click:e.logout}},[e._v("退出登录")])],1)]),t("el-tab-pane",{attrs:{label:"通用设置"}},[t("el-form",{ref:"form",attrs:{model:e.setting,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"发送消息："}},[t("el-radio-group",{model:{value:e.setting.sendKey,callback:function(t){e.$set(e.setting,"sendKey",t)},expression:"setting.sendKey"}},[t("el-radio-button",{attrs:{label:"1"}},[e._v("Enter")]),t("el-radio-button",{attrs:{label:"2"}},[e._v("Ctrl + Enter")])],1)],1),t("el-form-item",{attrs:{label:"系统主题："}},[t("el-radio-group",{model:{value:e.setting.theme,callback:function(t){e.$set(e.setting,"theme",t)},expression:"setting.theme"}},[t("el-radio-button",{attrs:{label:"default"}}),t("el-radio-button",{attrs:{label:"blue"}})],1)],1)],1),t("div",{staticClass:"setting-switch"},[t("el-switch",{model:{value:e.setting.isVoice,callback:function(t){e.$set(e.setting,"isVoice",t)},expression:"setting.isVoice"}}),e._v(" 开启新消息声音提醒 ")],1),t("div",{staticClass:"setting-switch"},[t("el-switch",{model:{value:e.setting.avatarCricle,callback:function(t){e.$set(e.setting,"avatarCricle",t)},expression:"setting.avatarCricle"}}),e._v(" 开启聊天圆形头像（需要刷新） ")],1),t("div",{staticClass:"setting-switch"},[t("el-switch",{model:{value:e.setting.hideMessageName,callback:function(t){e.$set(e.setting,"hideMessageName",t)},expression:"setting.hideMessageName"}}),e._v(" 是否隐藏聊天窗口内的联系人名字 ")],1),t("div",{staticClass:"setting-switch"},[t("el-switch",{model:{value:e.setting.hideMessageTime,callback:function(t){e.$set(e.setting,"hideMessageTime",t)},expression:"setting.hideMessageTime"}}),e._v(" 是否隐藏聊天窗口内的消息发送时间 ")],1)],1),t("el-tab-pane",{attrs:{label:"关于 IM"}},[t("div",{attrs:{align:"center"}},[t("el-avatar",{attrs:{src:e.packageData.logo,size:50}}),t("br"),t("br"),t("p",[t("span",{staticClass:"main-color"},[e._v(" "+e._s(e.packageData.name)+" ")]),e._v("for "+e._s(e.packageData.version)+" ")])],1),t("div",{staticClass:"setting-version"},[t("b",[e._v(" 已经支持功能：")]),t("p",[e._v("1、单聊和群聊，新增消息管理器")]),t("p",[e._v("2、支持发送表情、图片、语音、视频和文件消息")]),t("p",[e._v("3、单聊支持消息已读未读的状态显示")]),t("p",[e._v("4、支持设置新消息声音提醒，浏览器通知")]),t("p",[e._v("5、支持部分Lemon-imui内功能设置")]),t("p",[e._v("6、支持文件、图片和绝大部分媒体文件在线预览")]),t("p",[e._v("7、群聊创建、删除和群成员管理、群公告、群禁言等")]),t("p",[e._v("8、可以置顶联系人，所有联系人可以设置消息免打扰")]),t("p",[e._v("9、全新支持增加音视频通话(一对一)")])])]),t("el-tab-pane",{attrs:{label:"开源"}},[t("div",{attrs:{align:"center"}},[t("el-avatar",{attrs:{src:e.packageData.logo,size:50}}),t("br"),t("br"),t("p",[t("span",{staticClass:"main-color"},[e._v(" "+e._s(e.packageData.name)+" ")]),e._v("for "+e._s(e.packageData.version)+" ")])],1),t("div",{staticClass:"setting-version"},[t("p",[e._v(" 前端地址："),t("a",{staticClass:"main-color",attrs:{href:e.packageData.frontUrl,target:"_blank"}},[e._v("[链接] im-chat-front")])]),t("p",[e._v(" 后端地址："),t("a",{staticClass:"main-color",attrs:{href:e.packageData.backstageUrl,target:"_blank"}},[e._v("[链接] im-instant-chat")])])]),t("div",{staticClass:"setting-version",staticStyle:{color:"#a6a6a6"}},[t("p",[e._v("前端技术栈：vue+Lemon-IMUI+element-UI")]),t("p",[e._v("后端技术栈：thinkphp6+workerman")])]),t("div",{staticClass:"setting-version"},[t("p",[e._v(" QQ交流群： "),t("a",{staticClass:"main-color",attrs:{href:"https://jq.qq.com/?_wv=1027&k=jMQAt9lh",target:"_blank"}},[e._v("336921267")])])])])],1)],1),t("el-dialog",{attrs:{title:"发布公告",visible:e.noticeBox,modal:!0,width:"500px"},on:{"update:visible":function(t){e.noticeBox=t}}},[t("el-input",{attrs:{type:"textarea",rows:10,placeholder:"请输入内容"},model:{value:e.notice,callback:function(t){e.notice=t},expression:"notice"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.noticeBox=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.publishNotice}},[e._v("确 定")])],1)],1),t("transition",{attrs:{name:"fade-user"}},[e.drawer?t("div",{staticClass:"previewBox"},[t("el-button",{staticClass:"drawer-close",attrs:{type:"danger",icon:"el-icon-close",circle:""},on:{click:function(t){e.drawer=!e.drawer}}}),t("iframe",{attrs:{src:e.previewUrl,frameborder:"0",width:"100%",height:"100%"}})],1):e._e()]),t("el-dialog",{attrs:{title:"转发",visible:e.forwardBox,modal:!0,width:"612px"},on:{"update:visible":function(t){e.forwardBox=t}}},[t("el-transfer",{attrs:{filterable:"",titles:e.createChatTitles,"filter-placeholder":"请输入关键词",props:e.contactsProps,data:e.allUser},model:{value:e.selectUid,callback:function(t){e.selectUid=t},expression:"selectUid"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.forwardBox=!1,e.selectUid=[]}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.forwardUser}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"消息管理器",visible:e.messageBox,modal:!0,width:"800px"},on:{"update:visible":function(t){e.messageBox=t}}},[t("ChatRecord",{key:e.componentKey,attrs:{contact:e.currentChat}})],1),t("el-dialog",{attrs:{title:"群设置",visible:e.groupSetting,modal:!0,width:"500px"},on:{"update:visible":function(t){e.groupSetting=t}}},[t("ChatSet",{key:e.componentKey,attrs:{contact:e.contactSetting}})],1),t("el-dialog",{attrs:{title:"语音录制","custom-class":"no-padding",visible:e.VoiceStatus,modal:!0,width:"500px","append-to-body":"","destroy-on-close":""},on:{"update:visible":function(t){e.VoiceStatus=t}}},[t("voice-recorder",{on:{send:e.sendVoice}})],1),t("Socket",{ref:"socket"}),t("webrtc",{key:e.componentKey,ref:"webrtc",attrs:{contact:e.currentChat,config:e.webrtcConfig,alias:e.packageData.name,userInfo:e.user}})],1)},b=[],y=s(9658),M=y.Z,x=(0,p.Z)(M,C,b,!1,null,"c8913bc8",null),k=x.exports,D=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-wrapper",style:"background-image:url("+e.Background+")"},[t("div",{staticClass:"form-box"},[t("div",{staticClass:"form-title"},[t("img",{attrs:{src:e.packageData.logo,width:"100",alt:"icon"}})]),t("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules,"label-width":"0px"}},[t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{ref:"username",attrs:{type:"text","auto-complete":"off",placeholder:"请输入账号","prefix-icon":"el-icon-user"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"请输入密码","prefix-icon":"el-icon-lock"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),t("div",{staticClass:"c-666",staticStyle:{"font-size":"12px"}},[e._v("演示账号：13800000001~13800000009，密码:123456")]),t("el-form-item",[t("el-checkbox",{model:{value:e.loginForm.rememberMe,callback:function(t){e.$set(e.loginForm,"rememberMe",t)},expression:"loginForm.rememberMe"}},[e._v("记住我")])],1),t("el-form-item",[t("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.loading,size:"small",type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin.apply(null,arguments)}}},[e.loading?t("span",[e._v("登 录 中...")]):t("span",[e._v("登 录")])])],1),t("div",{staticClass:"c-999",attrs:{align:"center"}},[e._v(e._s(e.packageData.name)+" for "+e._s(e.packageData.version))])],1)],1)])},E=[],O=s(3074),U={name:"Login",data(){return{Background:O,packageData:o,loginForm:{username:"13800000002",password:"123456",rememberMe:!0},loginRules:{username:[{required:!0,trigger:"blur",message:"用户名不能为空"}],password:[{required:!0,trigger:"blur",message:"密码不能为空"}]},loading:!1,redirect:void 0}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect},immediate:!0}},mounted(){this.$nextTick((()=>{this.$refs.username.focus()}))},methods:{handleLogin(){this.$refs.loginForm.validate((e=>{const t={username:this.loginForm.username,password:this.loginForm.password};e&&(this.loading=!0,this.$store.dispatch("Login",t).then((e=>{window.location.reload()})).catch((()=>{this.loading=!1})))}))}}},I=U,T=(0,p.Z)(I,D,E,!1,null,null,null),P=T.exports;i["default"].use(a.ZP);const K=[{path:"/",name:"home",component:w,meta:{title:"首页"}},{path:"/chat",name:"chat",component:k,meta:{title:"聊天"}},{path:"/login",name:"login",component:P,meta:{title:"登录"}},{path:"*",redirect:"/404",hidden:!0},{path:"/404",component:()=>s.e(560).then(s.bind(s,8560)),hidden:!0}],S=()=>new a.ZP({mode:"hash",scrollBehavior:()=>({y:0}),routes:K}),B=S();function L(){const e=S();B.matcher=e.matcher}var A=B},4239:function(e,t,s){"use strict";var i=s(3032),a=s(3822),n=s(4462),r=s.n(n),o=s(9886),c=s(2223),l=s(3587);i["default"].use(a.ZP);const d={userInfo:null,allAuth:null,socketAction:"",contactSync:"",toContactId:0,unread:0,allContacts:[]},u={SET_USERINFO:(e,t)=>{e.userInfo=t,localStorage.setItem("loginUserInfo",JSON.stringify(t)),r().set("UserInfo",t)},SET_AUTH:(e,t)=>{const s=t.authToken,i=t.sessionId;r().set("authToken",s),r().set("sessionId",i),(0,o.Ei)(s,i)},catchSocketAction(e,t){e.socketAction=t},updateUnread:(e,t)=>{e.unread=parseInt(t)},initContacts:(e,t)=>{e.allContacts=t},openChat:(e,t)=>{e.toContactId=t,e.contactSync=Math.random().toString(36).substr(-8)}},_={Login({commit:e,dispatch:t},s){return new Promise(((i,a)=>{(0,c.UO)(s).then((t=>{const s=t.data||s;e("SET_AUTH",s),e("SET_USERINFO",s.userInfo),i(t)})).catch((e=>{console.log(e),t("LogOut"),a(e)}))}))},GetUserInfo({commit:e,state:t}){return new Promise(((e,t)=>{}))},LogOut({commit:e}){return new Promise(((e,t)=>{(0,c.y5)().then((()=>{r().rm("authToken"),r().rm("sessionId"),(0,o.M7)(),(0,l.PV)(),e()})).catch((e=>{t(e)}))}))}};t["Z"]=new a.ZP.Store({state:d,mutations:u,actions:_})},9886:function(e,t,s){"use strict";s.d(t,{Ei:function(){return u},v0:function(){return _},M7:function(){return d}});var i=s(6265),a=s.n(i),n=s(4239),r=s(4462),o=s.n(r);const c={loadingCache:function(){if(o().get("authKey")&&!a().defaults.headers.authKey){const e=o().get("loginUserInfo");e&&n.Z.commit("SET_USERINFO",e)}n.Z.commit("SET_APPNAME",o().get("systemName")),n.Z.commit("SET_APPLOGO",o().get("systemLogo"))},updateAxiosCache:function(){a().defaults.headers.authKey=o().get("authKey"),a().defaults.headers.sessionId=o().get("sessionId"),n.Z.dispatch("GetUserInfo")},updateAxiosHeaders:function(){a().defaults.headers.authKey=o().get("authKey"),a().defaults.headers.sessionId=o().get("sessionId")},rmAxiosCache:function(){o().rm("authKey"),o().rm("sessionId")}};var l=c;function d(){return new Promise(((e,t)=>{l.rmAxiosCache(),delete a().defaults.headers.authToken,delete a().defaults.headers.sessionId,e(!0)}))}function u(e,t){return new Promise(((s,i)=>{a().defaults.headers.authToken=e,a().defaults.headers.sessionId=t,s(!0)}))}function _(){return o().get("authToken")&&!a().defaults.headers.authToken&&l.updateAxiosCache(),!!o().get("authToken")}},845:function(e,t){"use strict";t["Z"]=[{label:"表情",children:[{name:"1f600",title:"微笑",src:"https://emoji.raingad.com/72x72/1f600.png"},{name:"1f62c",title:"微笑",src:"https://emoji.raingad.com/72x72/1f62c.png"},{name:"1f601",title:"微笑",src:"https://emoji.raingad.com/72x72/1f601.png"},{name:"1f602",title:"微笑",src:"https://emoji.raingad.com/72x72/1f602.png"},{name:"1f923",title:"微笑",src:"https://emoji.raingad.com/72x72/1f923.png"},{name:"1f973",title:"微笑",src:"https://emoji.raingad.com/72x72/1f973.png"},{name:"1f603",title:"微笑",src:"https://emoji.raingad.com/72x72/1f603.png"},{name:"1f604",title:"微笑",src:"https://emoji.raingad.com/72x72/1f604.png"},{name:"1f605",title:"微笑",src:"https://emoji.raingad.com/72x72/1f605.png"},{name:"1f606",title:"微笑",src:"https://emoji.raingad.com/72x72/1f606.png"},{name:"1f607",title:"微笑",src:"https://emoji.raingad.com/72x72/1f607.png"},{name:"1f609",title:"微笑",src:"https://emoji.raingad.com/72x72/1f609.png"},{name:"1f60a",title:"微笑",src:"https://emoji.raingad.com/72x72/1f60a.png"},{name:"1f642",title:"微笑",src:"https://emoji.raingad.com/72x72/1f642.png"},{name:"1f643",title:"微笑",src:"https://emoji.raingad.com/72x72/1f643.png"},{name:"1263a",title:"微笑",src:"https://emoji.raingad.com/72x72/263a.png"},{name:"1f60b",title:"微笑",src:"https://emoji.raingad.com/72x72/1f60b.png"},{name:"1f60c",title:"微笑",src:"https://emoji.raingad.com/72x72/1f60c.png"},{name:"1f60d",title:"微笑",src:"https://emoji.raingad.com/72x72/1f60d.png"},{name:"1f970",title:"微笑",src:"https://emoji.raingad.com/72x72/1f970.png"},{name:"1f618",title:"微笑",src:"https://emoji.raingad.com/72x72/1f618.png"},{name:"1f617",title:"微笑",src:"https://emoji.raingad.com/72x72/1f617.png"},{name:"1f619",title:"微笑",src:"https://emoji.raingad.com/72x72/1f619.png"},{name:"1f61a",title:"微笑",src:"https://emoji.raingad.com/72x72/1f61a.png"},{name:"1f61c",title:"微笑",src:"https://emoji.raingad.com/72x72/1f61c.png"},{name:"1f92a",title:"微笑",src:"https://emoji.raingad.com/72x72/1f92a.png"},{name:"1f928",title:"微笑",src:"https://emoji.raingad.com/72x72/1f928.png"},{name:"1f9d0",title:"微笑",src:"https://emoji.raingad.com/72x72/1f9d0.png"},{name:"1f61d",title:"微笑",src:"https://emoji.raingad.com/72x72/1f61d.png"},{name:"1f61b",title:"微笑",src:"https://emoji.raingad.com/72x72/1f61b.png"},{name:"1f911",title:"微笑",src:"https://emoji.raingad.com/72x72/1f911.png"},{name:"1f913",title:"微笑",src:"https://emoji.raingad.com/72x72/1f913.png"},{name:"1f60e",title:"微笑",src:"https://emoji.raingad.com/72x72/1f60e.png"},{name:"1f929",title:"微笑",src:"https://emoji.raingad.com/72x72/1f929.png"},{name:"1f921",title:"微笑",src:"https://emoji.raingad.com/72x72/1f921.png"},{name:"1f920",title:"微笑",src:"https://emoji.raingad.com/72x72/1f920.png"},{name:"1f917",title:"微笑",src:"https://emoji.raingad.com/72x72/1f917.png"},{name:"1f60f",title:"微笑",src:"https://emoji.raingad.com/72x72/1f60f.png"},{name:"1f636",title:"微笑",src:"https://emoji.raingad.com/72x72/1f636.png"},{name:"1f610",title:"微笑",src:"https://emoji.raingad.com/72x72/1f610.png"},{name:"1f611",title:"微笑",src:"https://emoji.raingad.com/72x72/1f611.png"},{name:"1f612",title:"微笑",src:"https://emoji.raingad.com/72x72/1f612.png"},{name:"1f644",title:"微笑",src:"https://emoji.raingad.com/72x72/1f644.png"},{name:"1f914",title:"微笑",src:"https://emoji.raingad.com/72x72/1f914.png"},{name:"1f925",title:"微笑",src:"https://emoji.raingad.com/72x72/1f925.png"},{name:"1f92d",title:"微笑",src:"https://emoji.raingad.com/72x72/1f92d.png"},{name:"1f92b",title:"微笑",src:"https://emoji.raingad.com/72x72/1f92b.png"},{name:"1f92c",title:"微笑",src:"https://emoji.raingad.com/72x72/1f92c.png"},{name:"1f92f",title:"微笑",src:"https://emoji.raingad.com/72x72/1f92f.png"},{name:"1f633",title:"微笑",src:"https://emoji.raingad.com/72x72/1f633.png"},{name:"1f61e",title:"微笑",src:"https://emoji.raingad.com/72x72/1f61e.png"},{name:"1f61f",title:"微笑",src:"https://emoji.raingad.com/72x72/1f61f.png"},{name:"1f620",title:"微笑",src:"https://emoji.raingad.com/72x72/1f620.png"},{name:"1f621",title:"微笑",src:"https://emoji.raingad.com/72x72/1f621.png"}]},{label:"收藏",children:[{name:"1f62c",title:"微笑",src:"https://emoji.raingad.com/72x72/1f62c.png"},{name:"1f621",title:"微笑",src:"https://emoji.raingad.com/72x72/1f621.png"}]}]},2325:function(e,t,s){"use strict";s.d(t,{L4:function(){return r},NW:function(){return d},Nj:function(){return a},hT:function(){return c},i$:function(){return o},iu:function(){return i},pH:function(){return n}});s(2801),s(7658),s(3408),s(4590);function i(e,t,s){if("object"!==typeof e)return!1;for(var i=[],a=0;e.length>a;a++)if("object"==typeof t)for(var n=0;t.length>n;n++){var r=t[n],o=e[a][r];if(-1!=o.indexOf(s)){i.push(e[a]);break}}else{o=e[a][t];-1!=o.indexOf(s)&&i.push(e[a])}return i}function a(e,t,s){s="undefined"!==typeof s&&s;for(var i=[],a=0;a<e.length;a++)i.push(e[a][t]);return!0===s?i.join(","):i}function n(e,t,s){for(var i=0;i<e.length;i++)e[i][t]==s&&e.splice(i,1);return e}function r(e,t,s){for(var i=0;i<e.length;i++)e[i]["disabled"]=!1,e[i][t]==s&&(e[i]["disabled"]=!0);return e}function o(e){var t=parseInt(e/1e3);return l(e)?c("H:i",t):c("Y/m/d",t)}function c(e,t){var s=t?new Date(1e3*t):new Date,i=function(e,t){return(e+="").length<t?new Array(++t-e.length).join("0")+e:e},a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n={1:"st",2:"nd",3:"rd",21:"st",22:"nd",23:"rd",31:"st"},r=["","January","February","March","April","May","June","July","August","September","October","November","December"],o={d:function(){return i(o.j(),2)},D:function(){return o.l().substr(0,3)},j:function(){return s.getDate()},l:function(){return a[o.w()]},N:function(){return o.w()+1},S:function(){return n[o.j()]?n[o.j()]:"th"},w:function(){return s.getDay()},z:function(){return(s-new Date(s.getFullYear()+"/1/1"))/864e5>>0},W:function(){var e,t=o.z(),i=364+o.L()-t,a=(new Date(s.getFullYear()+"/1/1").getDay()||7)-1;return i<=2&&(s.getDay()||7)-1<=2-i?1:t<=2&&a>=4&&t>=6-a?(e=new Date(s.getFullYear()-1+"/12/31"),c("W",Math.round(e.getTime()/1e3))):1+(a<=3?(t+a)/7:(t-(7-a))/7)>>0},F:function(){return r[o.n()]},m:function(){return i(o.n(),2)},M:function(){return o.F().substr(0,3)},n:function(){return s.getMonth()+1},t:function(){var e;return 2===(e=s.getMonth()+1)?28+o.L():1&e&&e<8||!(1&e)&&e>7?31:30},L:function(){var e=o.Y();return 3&e||!(e%100)&&e%400?0:1},Y:function(){return s.getFullYear()},y:function(){return(s.getFullYear()+"").slice(2)},a:function(){return s.getHours()>11?"pm":"am"},A:function(){return o.a().toUpperCase()},B:function(){var e=60*(s.getTimezoneOffset()+60),t=3600*s.getHours()+60*s.getMinutes()+s.getSeconds()+e,i=Math.floor(t/86.4);return i>1e3&&(i-=1e3),i<0&&(i+=1e3),1===String(i).length&&(i="00"+i),2===String(i).length&&(i="0"+i),i},g:function(){return s.getHours()%12||12},G:function(){return s.getHours()},h:function(){return i(o.g(),2)},H:function(){return i(s.getHours(),2)},i:function(){return i(s.getMinutes(),2)},s:function(){return i(s.getSeconds(),2)},O:function(){var e=i(Math.abs(s.getTimezoneOffset()/60*100),4);return e=s.getTimezoneOffset()>0?"-"+e:"+"+e,e},P:function(){var e=o.O();return e.substr(0,3)+":"+e.substr(3,2)},c:function(){return o.Y()+"-"+o.m()+"-"+o.d()+"T"+o.h()+":"+o.i()+":"+o.s()+o.P()},U:function(){return Math.round(s.getTime()/1e3)}};let l="";return e.replace(/[\\]?([a-zA-Z])/g,(function(e,t){return l=e!==t?t:o[t]?o[t]():t,l}))}function l(e){return(new Date).getTime()-e<864e5}function d(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var s=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?s:3&s|8).toString(16)}));return t}},4471:function(e,t,s){"use strict";var i=s(6265),a=s.n(i),n=s(8499),r=s(9886),o=s(5410),c=s.n(o),l=s(9070),d=(s(3587),s(4462)),u=s.n(d);const _=(0,l.debounce)(500,(()=>{(0,r.M7)().then((()=>{location.reload()})).catch((()=>{location.reload()}))})),p=(0,l.debounce)(500,((e,t="error")=>{(0,n.Message)({message:e,duration:1500,type:t})})),m=(0,l.debounce)(1e3,(e=>{n.MessageBox.confirm(e,"提示",{confirmButtonText:"确定",showCancelButton:!1,type:"warning"}).then((()=>{_()})).catch((()=>{}))}));a().defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8";let h=[];h=-1!=window.location.href.indexOf("index.html")?window.location.href.split("index.html"):window.location.href.split("#");const g=h.length>0?h[0]:window.location.href;window.BASE_URL=g+"/";const f=a().create({baseURL:window.BASE_URL,timeout:6e4});f.interceptors.request.use((e=>{const t=u().get("sessionId"),s=u().get("authToken");t&&s&&(e.headers["sessionId"]=t,e.headers["authToken"]=s);const i=e.headers["Content-Type"]&&-1!==e.headers["Content-Type"].indexOf("application/json");if(i)void 0!==e.data&&null!==e.data||(e.data={});else{const t=e.headers["Content-Type"]&&-1!==e.headers["Content-Type"].indexOf("multipart/form-data");e.data=t?e.data:c().stringify(e.data)}return e}),(e=>Promise.reject(e))),f.interceptors.response.use((e=>{const t=e.data;if(200!==e.status||"blob"!==e.config.responseType)return 0!==t.code?(-1===t.code?m(t.msg):p(t.msg),Promise.reject(t)):t;if(e.headers["content-disposition"]||e.headers["content-type"]&&-1!=e.headers["content-type"].indexOf("application/pdf"))return e;{const t=new Blob([e.data],{type:"application/json"}),s=new FileReader;s.onload=function(){const e=JSON.parse(this.result);e.msg&&p(e.msg,1==e.code?"success":"error")},s.readAsText(t)}}),(e=>{if(e.response){const t=e.response;500==t.status?p("网络错误，请检查您的网络"):t.data&&t.data.msg&&p(t.data.msg)}return Promise.reject(e)})),t["Z"]=f},3074:function(e,t,s){"use strict";e.exports=s.p+"assets/img/login-background.2ae4dd8e.jpg"},444:function(e,t,s){"use strict";e.exports=s.p+"assets/media/notify.3d49176d.mp3"},4654:function(){},4147:function(e){"use strict";e.exports=JSON.parse('{"name":"Raingad-IM","version":"2.5.20","description":"一款基于vue2.0的即时聊天工具","logo":"https://im.file.raingad.com/logo/logo.png","frontUrl":"https://gitee.com/raingad/im-chat-front","backstageUrl":"https://gitee.com/raingad/im-instant-chat","mobileUrl":"https://im.raingad.com/web","author":"Raingad","license":"Apache2.0","qqGroupUrl":"https://jq.qq.com/?_wv=1027&k=jMQAt9lh","private":true,"scripts":{"serve":"vue-cli-service serve","build":"vue-cli-service build","lint":"vue-cli-service lint"},"dependencies":{"axios":"^0.21.4","core-js":"^3.8.3","element-ui":"^2.15.1","js-audio-recorder":"^1.0.7","lemon-imui":"^1.7.6","lockr":"^0.8.5","nprogress":"^0.2.0","v-clipboard":"^2.2.3","vue":"^2.6.14","vue-router":"^3.5.1","vuex":"^3.6.2"},"devDependencies":{"@babel/core":"^7.12.16","@babel/eslint-parser":"^7.12.16","@vue/cli-plugin-babel":"~5.0.0","@vue/cli-plugin-eslint":"~5.0.0","@vue/cli-plugin-router":"~5.0.0","@vue/cli-plugin-vuex":"~5.0.0","@vue/cli-service":"~5.0.0","eslint":"^7.32.0","eslint-config-prettier":"^8.3.0","eslint-plugin-prettier":"^4.0.0","eslint-plugin-vue":"^8.0.3","prettier":"^2.4.1","sass":"^1.32.7","sass-loader":"^12.0.0","vue-template-compiler":"^2.6.14"},"rules":{"generator-star-spacing":"off","no-tabs":"off","no-unused-vars":"off","no-console":"off","no-irregular-whitespace":"off","no-debugger":"off"}}')}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(s.exports,s,s.exports,__webpack_require__),s.exports}__webpack_require__.m=__webpack_modules__,function(){var e=[];__webpack_require__.O=function(t,s,i,a){if(!s){var n=1/0;for(l=0;l<e.length;l++){s=e[l][0],i=e[l][1],a=e[l][2];for(var r=!0,o=0;o<s.length;o++)(!1&a||n>=a)&&Object.keys(__webpack_require__.O).every((function(e){return __webpack_require__.O[e](s[o])}))?s.splice(o--,1):(r=!1,a<n&&(n=a));if(r){e.splice(l--,1);var c=i();void 0!==c&&(t=c)}}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[s,i,a]}}(),function(){__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return __webpack_require__.d(t,{a:t}),t}}(),function(){__webpack_require__.d=function(e,t){for(var s in t)__webpack_require__.o(t,s)&&!__webpack_require__.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){__webpack_require__.f={},__webpack_require__.e=function(e){return Promise.all(Object.keys(__webpack_require__.f).reduce((function(t,s){return __webpack_require__.f[s](e,t),t}),[]))}}(),function(){__webpack_require__.u=function(e){return"assets/js/"+e+".3ede13aa.js"}}(),function(){__webpack_require__.miniCssF=function(e){return"assets/css/"+e+".9bee72a6.css"}}(),function(){__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="Raingad-IM:";__webpack_require__.l=function(s,i,a,n){if(e[s])e[s].push(i);else{var r,o;if(void 0!==a)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var d=c[l];if(d.getAttribute("src")==s||d.getAttribute("data-webpack")==t+a){r=d;break}}r||(o=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,__webpack_require__.nc&&r.setAttribute("nonce",__webpack_require__.nc),r.setAttribute("data-webpack",t+a),r.src=s),e[s]=[i];var u=function(t,i){r.onerror=r.onload=null,clearTimeout(_);var a=e[s];if(delete e[s],r.parentNode&&r.parentNode.removeChild(r),a&&a.forEach((function(e){return e(i)})),t)return t(i)},_=setTimeout(u.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=u.bind(null,r.onerror),r.onload=u.bind(null,r.onload),o&&document.head.appendChild(r)}}}(),function(){__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){__webpack_require__.p=""}(),function(){var e=function(e,t,s,i){var a=document.createElement("link");a.rel="stylesheet",a.type="text/css";var n=function(n){if(a.onerror=a.onload=null,"load"===n.type)s();else{var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=r,c.request=o,a.parentNode.removeChild(a),i(c)}};return a.onerror=a.onload=n,a.href=t,document.head.appendChild(a),a},t=function(e,t){for(var s=document.getElementsByTagName("link"),i=0;i<s.length;i++){var a=s[i],n=a.getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(n===e||n===t))return a}var r=document.getElementsByTagName("style");for(i=0;i<r.length;i++){a=r[i],n=a.getAttribute("data-href");if(n===e||n===t)return a}},s=function(s){return new Promise((function(i,a){var n=__webpack_require__.miniCssF(s),r=__webpack_require__.p+n;if(t(n,r))return i();e(s,r,i,a)}))},i={143:0};__webpack_require__.f.miniCss=function(e,t){var a={560:1};i[e]?t.push(i[e]):0!==i[e]&&a[e]&&t.push(i[e]=s(e).then((function(){i[e]=0}),(function(t){throw delete i[e],t})))}}(),function(){var e={143:0};__webpack_require__.f.j=function(t,s){var i=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==i)if(i)s.push(i[2]);else{var a=new Promise((function(s,a){i=e[t]=[s,a]}));s.push(i[2]=a);var n=__webpack_require__.p+__webpack_require__.u(t),r=new Error,o=function(s){if(__webpack_require__.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var a=s&&("load"===s.type?"missing":s.type),n=s&&s.target&&s.target.src;r.message="Loading chunk "+t+" failed.\n("+a+": "+n+")",r.name="ChunkLoadError",r.type=a,r.request=n,i[1](r)}};__webpack_require__.l(n,o,"chunk-"+t,t)}},__webpack_require__.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,a,n=s[0],r=s[1],o=s[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(i in r)__webpack_require__.o(r,i)&&(__webpack_require__.m[i]=r[i]);if(o)var l=o(__webpack_require__)}for(t&&t(s);c<n.length;c++)a=n[c],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return __webpack_require__.O(l)},s=self["webpackChunkRaingad_IM"]=self["webpackChunkRaingad_IM"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var __webpack_exports__=__webpack_require__.O(void 0,[998],(function(){return __webpack_require__(8692)}));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();